{"version":3,"file":"index-Df9nnsZt.js","sources":["../../script.js"],"sourcesContent":["console.log(\"script.js carregado!\");\nconst products = [\n    { id: 0, name: \"Complement hidratante para cabelos\", catalogPrice: 57.9, weight: 0.17 },\n    { id: 1, name: \"Condicionador completive especial\", catalogPrice: 57.9, weight: 0.31 },\n    { id: 2, name: \"Óleo de tratamento para cabelos\", catalogPrice: 64.9, weight: 0.15 },\n    { id: 3, name: \"Shampoo especial aditivado\", catalogPrice: 58.9, weight: 0.34 },\n    { id: 4, name: \"Shampoo para cabelos normais\", catalogPrice: 57.9, weight: 0.35 },\n    { id: 5, name: \"Shampoo para cabelos oleosos\", catalogPrice: 58.9, weight: 0.335 },\n    { id: 6, name: \"Shampoo para cabelos secos e danificados\", catalogPrice: 57.9, weight: 0.325 },\n    { id: 7, name: \"Creme colágeno\", catalogPrice: 74.9, weight: 0.075 },\n    { id: 8, name: \"Creme hidratante facial\", catalogPrice: 58.9, weight: 0.075 },\n    { id: 9, name: \"Creme para limpeza facial\", catalogPrice: 51.9, weight: 0.075 },\n    { id: 10, name: \"Gel facial esfoliante\", catalogPrice: 51.9, weight: 0.08 },\n    { id: 11, name: \"Loção tônica facial\", catalogPrice: 55.9, weight: 0.175 },\n    { id: 12, name: \"Óleo vitaminado para a pele facial\", catalogPrice: 51.9, weight: 0.026 },\n    { id: 13, name: \"Máscara facial SPArgila amarela peel off\", catalogPrice: 74.9, weight: 0.095 },\n    { id: 14, name: \"Creme para mãos e unhas\", catalogPrice: 55.9, weight: 0.07 },\n    { id: 15, name: \"Creme para massagem corporal\", catalogPrice: 74.9, weight: 0.176 },\n    { id: 16, name: \"Creme para os pés\", catalogPrice: 55.9, weight: 0.075 },\n    { id: 17, name: \"Creme para os seios\", catalogPrice: 55.9, weight: 0.076 },\n    { id: 18, name: \"Creme peeling\", catalogPrice: 56.9, weight: 0.07 },\n    { id: 19, name: \"Lipo gel - Redutor de medidas\", catalogPrice: 85.9, weight: 0.28 },\n    { id: 20, name: \"Loção cremosa camomila\", catalogPrice: 62.9, weight: 0.282 },\n    { id: 21, name: \"Loção cremosa pepino\", catalogPrice: 62.9, weight: 0.283 },\n    { id: 22, name: \"Óleo de tratamento cosmético para o corpo\", catalogPrice: 74.9, weight: 0.152 },\n    { id: 23, name: \"Vela vegetal para massagem\", catalogPrice: 70.9, weight: 0.109 },\n    { id: 24, name: \"Banho de ervas\", catalogPrice: 62.9, weight: 0.18 },\n    { id: 25, name: \"Sabonete íntimo natural\", catalogPrice: 74.9, weight: 0.228 },\n    { id: 26, name: \"Desodorante antiperspirante\", catalogPrice: 55.9, weight: 0.075 },\n    { id: 27, name: \"Desodorante I\", catalogPrice: 90.9, weight: 0.251 },\n    { id: 28, name: \"Desodorante II\", catalogPrice: 90.9, weight: 0.249 },\n    { id: 29, name: \"Desodorante III\", catalogPrice: 90.9, weight: 0.251 },\n    { id: 30, name: \"Desodorante IV\", catalogPrice: 90.9, weight: 0.252 },\n    { id: 31, name: \"Desodorante V\", catalogPrice: 90.9, weight: 0.247 },\n    { id: 32, name: \"Gel refrescante pós Barba\", catalogPrice: 79.9, weight: 0.15 },\n    { id: 33, name: \"Catálogo\", catalogPrice: 23.9, applyGeneralDiscount: false, weight: 0.094 },\n    { id: 34, name: \"Talão de consumidor\", catalogPrice: 5.9, applyGeneralDiscount: false, weight: 0.07 }\n];\n\n// Configurações globais\nconst STORAGE_KEY = 'pedido-vendas-data';\n\n// Estado da aplicação\nlet orderState = {\n    resellerName: '',\n    address: '',\n    phone: '',\n    attendanceBy: '',\n    orderDate: '', // Vazio inicialmente\n    creditPaid: 0,\n    freight: 0,\n    transportOption: '', // Nova propriedade para transporte\n    installments: 1,\n    generalDiscount: 0,\n    generalDeadlineDays: 2, // Prazo geral padrão\n    paymentDays: [], // Vazio inicialmente\n    notes: '',\n    paymentMethods: {\n        pix: {\n            enabled: false,\n            details: ''\n        },\n        transfer: {\n            enabled: false,\n            details: ''\n        },\n        boleto: {\n            enabled: false\n        },\n        credit: {\n            enabled: false,\n            installments: 1\n        }\n    },\n    products: products.map(product => ({\n        ...product,\n        quantity: 0,\n        individualDiscount: null,\n        lot: ''\n    })),\n    additionalProducts: [],\n    packaging: []\n};\n\n// Inicialização da aplicação\ndocument.addEventListener('DOMContentLoaded', function() {\n    initializeApp();\n});\n\nfunction initializeApp() {\n    console.log(\"initializeApp: Iniciando...\");\n    loadSavedData();\n    setCurrentDate(); // Chamado após loadSavedData para garantir que a data seja definida\n    renderProductsTable();\n    renderPackagingTable();\n    setupEventListeners();\n    updateSummary();\n    updatePaymentDates();\n    renderPaymentDaysInputs();\n    updateInstallmentsText(); // MELHORIA 5: Atualizar texto singular/plural\n    \n    // Inicializar visibilidade do campo de parcelas do cartão de crédito\n    const creditCheckbox = document.getElementById('payment-credit');\n    if (creditCheckbox) {\n        toggleCreditInstallmentsField(creditCheckbox.checked);\n    }\n    \n    console.log(\"initializeApp: Finalizado.\");\n}\n\n// Função para mostrar/ocultar campo de parcelas do cartão de crédito\nfunction toggleCreditInstallmentsField(show) {\n    const creditDetails = document.querySelector('.credit-card-details');\n    if (creditDetails) {\n        creditDetails.style.display = show ? 'flex' : 'none';\n    }\n}\n\n// Função para definir data atual de Brasília\nfunction setCurrentDate() {\n    const orderDateElement = document.getElementById('order-date');\n    if (orderDateElement && !orderDateElement.value) {\n        // Obter data atual no fuso horário de Brasília (UTC-3)\n        const now = new Date();\n        const brasiliaOffset = -3 * 60; // UTC-3 em minutos\n        const utc = now.getTime() + (now.getTimezoneOffset() * 60000);\n        const brasiliaTime = new Date(utc + (brasiliaOffset * 60000));\n        \n        // Formatar para YYYY-MM-DD\n        const year = brasiliaTime.getFullYear();\n        const month = String(brasiliaTime.getMonth() + 1).padStart(2, '0');\n        const day = String(brasiliaTime.getDate()).padStart(2, '0');\n        const formattedDate = `${year}-${month}-${day}`;\n        \n        orderDateElement.value = formattedDate;\n        orderState.orderDate = formattedDate;\n    }\n    updatePaymentDates();\n}\n\n// Função para atualizar a data do Prazo Geral\nfunction updateGeneralDeadlineDate() {\n    const orderDateElement = document.getElementById('order-date');\n    const generalDeadlineDateElement = document.getElementById('general-deadline-date');\n    const generalDeadlineDaysInput = document.getElementById('general-deadline-days');\n    \n    if (!orderDateElement || !generalDeadlineDateElement) return;\n    \n    // Se o input estiver vazio, limpar a data também\n    if (!generalDeadlineDaysInput || !generalDeadlineDaysInput.value) {\n        generalDeadlineDateElement.textContent = '';\n        return;\n    }\n    \n    // Carregar valor do input se existir\n    if (generalDeadlineDaysInput && generalDeadlineDaysInput.value) {\n        orderState.generalDeadlineDays = parseInt(generalDeadlineDaysInput.value) || 0;\n    }\n    \n    const orderDate = orderDateElement.value ? new Date(orderDateElement.value + 'T00:00:00') : new Date();\n    const days = orderState.generalDeadlineDays || 0;\n    const deadlineDate = new Date(orderDate.getTime() + days * 24 * 60 * 60 * 1000);\n    \n    generalDeadlineDateElement.textContent = deadlineDate.toLocaleDateString('pt-BR');\n    \n    // Atualizar o valor do input se necessário\n    if (generalDeadlineDaysInput && !generalDeadlineDaysInput.value) {\n        generalDeadlineDaysInput.value = orderState.generalDeadlineDays;\n    }\n}\n\n// MELHORIA 6: Função para renderizar campos de prazo com 3 dígitos\nfunction renderPaymentDaysInputs() {\n    const container = document.getElementById('payment-days-container');\n    if (!container) return;\n    \n    container.innerHTML = '';\n\n    for (let i = 0; i < orderState.installments; i++) {\n        const dayItem = document.createElement('div');\n        dayItem.className = 'payment-day-item';\n        \n        // CORREÇÃO: Adicionar data dinâmica sem parênteses\n        const orderDateElement = document.getElementById('order-date');\n        const orderDate = orderDateElement ? new Date(orderDateElement.value) : new Date();\n        const days = orderState.paymentDays[i] || 0;\n        const paymentDate = new Date(orderDate.getTime() + (days + 1) * 24 * 60 * 60 * 1000);\n        const formattedDate = days > 0 ? paymentDate.toLocaleDateString('pt-BR') : '(definir prazo)';\n        \n        dayItem.innerHTML = `\\n            <label class=\\\"payment-day-label\\\">Prazo ${i + 1}ª Parcela</label>\\n            <div style=\\\"display: flex; align-items: center; gap: 8px;\\\">\\n                <input type=\\\"number\\\" \\n                       id=\\\"payment-days-${i}\\\" \\n                       value=\\\"${orderState.paymentDays[i] || ''}\\\" \\n                       min=\\\"1\\\" \\n                       max=\\\"999\\\"\\n                       step=\\\"1\\\" \\n                       data-installment-index=\\\"${i}\\\" \\n                       class=\\\"payment-day-input payment-days-input\\\"\\n                       placeholder=\\\"dias\\\"\\n                       style=\\\"width: 60px;\\\">\\n                <span class=\\\"payment-date-display\\\" id=\\\"payment-date-${i}\\\" style=\\\"font-size: 12px; color: #666;\\\">${formattedDate}</span>\\n            </div>\\n        `;\n        container.appendChild(dayItem);\n    }\n}\n\n// MELHORIA 5: Função para atualizar texto singular/plural\nfunction updateInstallmentsText() {\n    // Atualizar texto do Boleto\n    const boletoLabel = document.getElementById('boleto-installments-label');\n    const installmentsInput = document.getElementById('installments');\n    if (boletoLabel && installmentsInput) {\n        const count = parseInt(installmentsInput.value) || 1;\n        boletoLabel.textContent = count === 1 ? 'Parcela' : 'Parcelas';\n    }\n    \n    // Atualizar texto do Cartão de Crédito\n    const creditLabel = document.getElementById('payment-installments-label');\n    const creditInput = document.getElementById('payment-credit-installments');\n    if (creditLabel && creditInput) {\n        const count = parseInt(creditInput.value) || 1;\n        creditLabel.textContent = count === 1 ? 'Parcela' : 'Parcelas';\n    }\n}\n\nfunction updatePaymentDates() {\n    const orderDateElement = document.getElementById('order-date');\n    let orderDate;\n    \n    if (orderDateElement && orderDateElement.value) {\n        // Corrigir a interpretação da data\n        const dateValue = orderDateElement.value;\n        // Se o valor está no formato incorreto, tentar corrigir\n        if (dateValue.includes('-') && dateValue.length > 10) {\n            // Formato incorreto detectado, usar data atual como fallback\n            orderDate = new Date();\n        } else {\n            orderDate = new Date(dateValue + 'T00:00:00');\n        }\n    } else {\n        orderDate = new Date();\n    }\n    \n    const installmentsDetails = document.getElementById('installments-details');\n    if (!installmentsDetails) return;\n    \n    installmentsDetails.innerHTML = '';\n\n    const settlementValue = calculateSettlementValue();\n    const installmentValue = settlementValue / orderState.installments;\n\n    // Adicionar informacao do Cartao de Credito se selecionado\n    if (orderState.paymentMethods.credit.enabled) {\n        const creditInstallments = orderState.paymentMethods.credit.installments || 1;\n        const creditInstallmentValue = settlementValue / creditInstallments;\n        const creditItem = document.createElement('div');\n        creditItem.className = 'installment-item';\n        creditItem.innerHTML = `<strong class=\"highlight-settlement-date\">Cartao de Credito:</strong> <span class=\"highlight-settlement-date\">${creditInstallments} Parcela${creditInstallments > 1 ? 's' : ''} de ${formatCurrency(creditInstallmentValue)}</span>`;\n        installmentsDetails.appendChild(creditItem);\n    }\n\n    // Verificar se Boleto está selecionado\n    const isBoletoSelected = orderState.paymentMethods.boleto.enabled;\n    \n    if (isBoletoSelected) {\n        // Se Boleto: usar prazos específicos do Boleto\n        for (let i = 0; i < orderState.installments; i++) {\n            const days = orderState.paymentDays[i] || 0;\n            const paymentDate = new Date(orderDate.getTime() + days * 24 * 60 * 60 * 1000);\n            const installmentItem = document.createElement('div');\n            installmentItem.className = 'installment-item';\n            \n            if (orderState.installments === 1) {\n                installmentItem.innerHTML = `<strong class=\"highlight-settlement-date\">Acerto até dia:</strong> <span class=\"highlight-settlement-date\">${paymentDate.toLocaleDateString('pt-BR')}</span>`;\n            } else {\n                installmentItem.innerHTML = `<strong>${i + 1}ª Parcela ${formatCurrency(installmentValue)} - <span class=\"highlight-settlement-date\">(Acerto até dia):</span></strong> <span class=\"highlight-settlement-date\">${paymentDate.toLocaleDateString('pt-BR')}</span>`;\n            }\n            \n            installmentsDetails.appendChild(installmentItem);\n        }\n    } else {\n        // Se nenhum Boleto ou se PIX, Cartão ou Transferência: usar Prazo Geral (padrão)\n        const generalDeadlineDays = orderState.generalDeadlineDays || 0;\n        const paymentDate = new Date(orderDate.getTime() + generalDeadlineDays * 24 * 60 * 60 * 1000);\n        const installmentItem = document.createElement('div');\n        installmentItem.className = 'installment-item';\n        installmentItem.innerHTML = `<strong class=\"highlight-settlement-date\">Acerto até dia:</strong> <span class=\"highlight-settlement-date\">${paymentDate.toLocaleDateString('pt-BR')}</span>`;\n        installmentsDetails.appendChild(installmentItem);\n    }\n}\n\nfunction loadSavedData() {\n    const savedData = localStorage.getItem(STORAGE_KEY);\n    if (savedData) {\n        try {\n            const parsedData = JSON.parse(savedData);\n            orderState = {\n                ...orderState,\n                ...parsedData,\n                products: orderState.products.map((p, i) => ({\n                    ...p,\n                    ...(parsedData.products && parsedData.products[i] ? parsedData.products[i] : {}),\n                    individualDiscount: (parsedData.products && parsedData.products[i] && parsedData.products[i].individualDiscount !== undefined) ? parsedData.products[i].individualDiscount : null\n                })),\n                additionalProducts: parsedData.additionalProducts || [],\n                packaging: parsedData.packaging || []\n            };\n\n            // Carregar dados nos campos, mas não sobrescrever a data se ela já foi definida\n            document.getElementById('reseller-name').value = orderState.resellerName || '';\n            document.getElementById('address').value = orderState.address || '';\n            document.getElementById('phone').value = orderState.phone || '';\n            document.getElementById('attendance-by').value = orderState.attendanceBy || '';\n            \n            // Só carregar a data salva se o campo ainda estiver vazio\n            const orderDateElement = document.getElementById('order-date');\n            if (orderDateElement && !orderDateElement.value && orderState.orderDate) {\n                orderDateElement.value = orderState.orderDate;\n            }\n            \n            document.getElementById('credit-paid').value = orderState.creditPaid || 0;\n            document.getElementById('general-discount').value = orderState.generalDiscount || 0;\n            document.getElementById('freight').value = orderState.freight || 0;\n            document.getElementById('transport-select').value = orderState.transportOption || '';\n            document.getElementById('installments').value = orderState.installments || 1;\n            document.getElementById('notes').value = orderState.notes || '';\n            \n            // Carregar Prazo Geral (vazio se não houver valor salvo)\n            const generalDeadlineDaysInput = document.getElementById('general-deadline-days');\n            if (generalDeadlineDaysInput) {\n                generalDeadlineDaysInput.value = orderState.generalDeadlineDays || '';\n            }\n            \n            // Carregar formas de pagamento\n            if (orderState.paymentMethods) {\n                document.getElementById('payment-pix').checked = orderState.paymentMethods.pix.enabled;\n                document.getElementById('payment-pix-details').value = orderState.paymentMethods.pix.details;\n                document.getElementById('payment-transfer').checked = orderState.paymentMethods.transfer.enabled;\n                document.getElementById('payment-transfer-details').value = orderState.paymentMethods.transfer.details;\n                document.getElementById('payment-boleto').checked = orderState.paymentMethods.boleto.enabled;\n                document.getElementById('payment-credit').checked = orderState.paymentMethods.credit.enabled;\n                document.getElementById('payment-credit-installments').value = orderState.paymentMethods.credit.installments;\n            }\n        } catch (error) {\n            console.error('Erro ao carregar dados salvos:', error);\n        }\n    }\n}\n\nfunction saveData() {\n    try {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(orderState));\n    } catch (error) {\n        console.error('Erro ao salvar dados:', error);\n    }\n}\n\nfunction renderProductsTable(productsToDisplay = orderState.products) {\n    const tbody = document.getElementById(\"products-tbody\");\n    if (!tbody) {\n        console.error(\"renderProductsTable: Elemento products-tbody não encontrado\");\n        return;\n    }\n    \n    tbody.innerHTML = \"\";\n    \n    // CORREÇÃO: Sempre mostrar colunas de desconto (sempre true)\n    const hasAnyDiscount = true;\n    \n    productsToDisplay.forEach((product, index) => {\n        const row = createProductRow(product, index, false, hasAnyDiscount);\n        tbody.appendChild(row);\n    });\n\n    orderState.additionalProducts.forEach((product, index) => {\n        const row = createAdditionalProductRow(product, index, hasAnyDiscount);\n        tbody.appendChild(row);\n    });\n\n    const addRow = document.createElement('tr');\n    const colSpan = 7; // Agora são 7 colunas incluindo a coluna Lote\n    addRow.innerHTML = `\\n        <td colspan=\\\"${colSpan}\\\" style=\\\"text-align: right;\\\">\\n            <button id=\\\"add-new-product-btn\\\" class=\\\"btn btn-secondary\\\">+ Adicionar outro item</button>\\n        </td>\\n    `;\n    tbody.appendChild(addRow);\n\n    updateTableHeader(hasAnyDiscount);\n}\n\nfunction checkIfHasAnyDiscount() {\n    if (orderState.generalDiscount > 0) return true;\n    \n    for (let product of orderState.products) {\n        if (product.individualDiscount !== null && product.individualDiscount > 0) return true;\n    }\n    \n    for (let product of orderState.additionalProducts) {\n        if (product.individualDiscount !== null && product.individualDiscount > 0) return true;\n    }\n    \n    return false;\n}\n\nfunction updateTableHeader(hasAnyDiscount) {\n    const thead = document.querySelector('.products-table thead tr');\n    if (!thead) return;\n    \n    // CORREÇÃO: Sempre mostrar todas as colunas incluindo Lote\n    thead.innerHTML = `\\n        <th>Produto</th>\\n        <th>Quantidade</th>\\n        <th>Preço<br>Catálogo</th>\\n        <th>Desconto<br>(%)</th>\\n        <th>Preço c/<br>Desconto</th>\\n        <th>Total<br>Item</th>\\n        <th>Lote</th>\\n    `;\n}\n\nfunction createProductRow(product, index, isCustom = false, hasAnyDiscount = true) {\n    const row = document.createElement(\"tr\");\n    row.className = product.quantity > 0 ? \"has-quantity\" : \"\";\n    \n    let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : orderState.generalDiscount;\n    if (product.applyGeneralDiscount === false) {\n        effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n    }\n\n    const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n    const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n    const discountColumn = hasAnyDiscount ? `\\n        <td>\\n            <input type=\\\"number\\\" \\n                   value=\\\"${product.individualDiscount !== null ? product.individualDiscount : (product.applyGeneralDiscount !== false ? orderState.generalDiscount : '')}\\\" \\n                   min=\\\"0\\\" \\n                   max=\\\"100\\\"\\n                   step=\\\"0.1\\\"\\n                   placeholder=\\\"${product.applyGeneralDiscount === false ? \"0.0\" : orderState.generalDiscount.toFixed(1)}\\\"\\n                   data-product-id=\\\"${product.id}\\\"\\n                   class=\\\"discount-input ${product.individualDiscount !== null ? \"highlight-discount\" : \"\"}\\\">\\n        </td>\\n        <td class=\\\"price discounted-price\\\">${formatCurrency(discountedPrice)}</td>\\n    ` : '';\n    \n    row.innerHTML = `\\n        <td class=\\\"product-name\\\">${product.name}</td>\\n        <td>\\n            <input type=\\\"number\\\" \\n                   value=\\\"${product.quantity}\\\" \\n                   min=\\\"0\\\" \\n                   step=\\\"1\\\" \\n                   data-product-id=\\\"${product.id}\\\"\\n                   class=\\\"quantity-input\\\">\\n        </td>\\n        <td class=\\\"price\\\">${formatCurrency(product.catalogPrice)}</td>\\n        ${discountColumn}\\n        <td class=\\\"price total-price\\\">${formatCurrency(totalPrice)}</td>\\n        <td>\\n            <input type=\\\"text\\\" \\n                   value=\\\"${product.lot || ''}\\\" \\n                   maxlength=\\\"6\\\" \\n                   data-product-index=\\\"${index}\\\" \\n                   class=\\\"lot-input\\\">\\n        </td>\\n    `;\n    return row;\n}\n\nfunction createAdditionalProductRow(product, index, hasAnyDiscount = true) {\n    const row = document.createElement('tr');\n    row.className = `additional-product-row ${product.quantity > 0 ? 'has-quantity' : ''}`;\n    \n    let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n    const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n    const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n    const discountColumn = hasAnyDiscount ? `\\n        <td>\\n            <input type=\\\"number\\\" class=\\\"additional-product-discount-input ${product.individualDiscount !== null ? 'highlight-discount' : ''}\\\" \\n                   data-index=\\\"${index}\\\" \\n                   value=\\\"${product.individualDiscount !== null ? product.individualDiscount : ''}\\\" \\n                   min=\\\"0\\\" max=\\\"100\\\" step=\\\"0.1\\\" placeholder=\\\"0.0\\\">\\n        </td>\\n        <td class=\\\"price discounted-price\\\">${formatCurrency(discountedPrice)}</td>\\n    ` : '';\n\n    row.innerHTML = `\\n        <td><input type=\\\"text\\\" class=\\\"additional-product-name-input\\\" data-index=\\\"${index}\\\" value=\\\"${product.name}\\\" placeholder=\\\"Nome do Produto\\\"></td>\\n        <td><input type=\\\"number\\\" class=\\\"additional-product-quantity-input\\\" data-index=\\\"${index}\\\" value=\\\"${product.quantity}\\\" min=\\\"0\\\" step=\\\"1\\\" placeholder=\\\"0\\\"></td>\\n        <td><input type=\\\"number\\\" class=\\\"additional-product-price-input\\\" data-index=\\\"${index}\\\" value=\\\"${product.catalogPrice}\\\" min=\\\"0\\\" step=\\\"0.01\\\" placeholder=\\\"0.00\\\"></td>\\n        ${discountColumn}\\n        <td class=\\\"price total-price\\\">${formatCurrency(totalPrice)}</td>\\n        <td>\\n            <input type=\\\"text\\\" \\n                   value=\\\"${product.lot || ''}\\\" \\n                   maxlength=\\\"6\\\" \\n                   data-additional-index=\\\"${index}\\\" \\n                   class=\\\"lot-input\\\">\\n        </td>\\n    `;\n    return row;\n}\n\nfunction setupEventListeners() {\n    // Event listener para data do pedido\n    document.getElementById('order-date').addEventListener('change', function(e) {\n        orderState.orderDate = e.target.value;\n        updatePaymentDates();\n        saveData();\n    });\n\n    // Event listeners para campos básicos\n    document.addEventListener('input', function(e) {\n        if (e.target.classList.contains('quantity-input')) {\n            const productId = parseInt(e.target.dataset.productId);\n            const quantity = parseInt(e.target.value) || 0;\n            \n            // Encontrar o produto pelo ID\n            const product = orderState.products.find(p => p.id === productId);\n            if (product) {\n                product.quantity = quantity;\n                updateProductRowCalculations(e.target.closest('tr'), product);\n                updateSummary();\n                updatePaymentDates();\n                saveData();\n            }\n        }\n                if (e.target.classList.contains('discount-input')) {\n            const productId = parseInt(e.target.dataset.productId);\n            const discount = e.target.value === '' ? null : parseFloat(e.target.value);\n            \n            // Encontrar o produto pelo ID\n            const product = orderState.products.find(p => p.id === productId);\n            if (product) {\n                product.individualDiscount = discount;\n                updateProductRowCalculations(e.target.closest('tr'), product);\n                \n                if (discount !== null && discount > 0) {\n                    e.target.classList.add('highlight-discount');\n                } else {\n                    e.target.classList.remove('highlight-discount');\n                }\n                \n                updateSummary();\n                updatePaymentDates();\n                saveData();\n            }\n        }      // Event listeners para produtos adicionais\n        if (e.target.classList.contains('additional-product-quantity-input')) {\n            const index = parseInt(e.target.dataset.index);\n            const quantity = parseInt(e.target.value) || 0;\n            orderState.additionalProducts[index].quantity = quantity;\n            \n            updateAdditionalProductRowCalculations(e.target.closest('tr'), orderState.additionalProducts[index]);\n            \n            updateSummary();\n            updatePaymentDates();\n            saveData();\n        }\n        \n        if (e.target.classList.contains('additional-product-price-input')) {\n            const index = parseInt(e.target.dataset.index);\n            const price = parseFloat(e.target.value) || 0;\n            orderState.additionalProducts[index].catalogPrice = price;\n            \n            updateAdditionalProductRowCalculations(e.target.closest('tr'), orderState.additionalProducts[index]);\n            \n            updateSummary();\n            updatePaymentDates();\n            saveData();\n        }\n        \n        if (e.target.classList.contains('additional-product-discount-input')) {\n            const index = parseInt(e.target.dataset.index);\n            const discount = e.target.value === '' ? null : parseFloat(e.target.value);\n            orderState.additionalProducts[index].individualDiscount = discount;\n            \n            updateAdditionalProductRowCalculations(e.target.closest('tr'), orderState.additionalProducts[index]);\n            \n            updateSummary();\n            updatePaymentDates();\n            saveData();\n        }\n        \n        // Event listener para campos de lote\n        if (e.target.classList.contains('lot-input')) {\n            const index = parseInt(e.target.dataset.productIndex);\n            const additionalIndex = parseInt(e.target.dataset.additionalIndex);\n            \n            if (!isNaN(index) && index >= 0 && index < orderState.products.length) {\n                orderState.products[index].lot = e.target.value;\n                saveData();\n            } else if (!isNaN(additionalIndex) && additionalIndex >= 0 && additionalIndex < orderState.additionalProducts.length) {\n                orderState.additionalProducts[additionalIndex].lot = e.target.value;\n                saveData();\n            }\n        }\n        \n        // MELHORIA 6: Event listener para campos de prazo com 3 dígitos\n        if (e.target.classList.contains('payment-days-input')) {\n            const index = parseInt(e.target.dataset.installmentIndex);\n            const value = parseInt(e.target.value) || 0;\n            // Limitar a 3 dígitos (999)\n            if (value > 999) {\n                e.target.value = 999;\n                orderState.paymentDays[index] = 999;\n            } else {\n                orderState.paymentDays[index] = value;\n            }\n            \n            // CORREÇÃO: Atualizar data dinâmica sem parênteses\n            const orderDateElement = document.getElementById('order-date');\n            const orderDate = orderDateElement ? new Date(orderDateElement.value) : new Date();\n            const days = orderState.paymentDays[index] || 0;\n            const paymentDate = new Date(orderDate.getTime() + (days + 1) * 24 * 60 * 60 * 1000);\n            const formattedDate = days > 0 ? paymentDate.toLocaleDateString('pt-BR') : '(definir prazo)';\n            \n            const dateDisplay = document.getElementById(`payment-date-${index}`);\n            if (dateDisplay) {\n                dateDisplay.textContent = formattedDate;\n            }\n            \n            updatePaymentDates();\n            saveData();\n        }\n        \n        if (e.target.classList.contains('additional-product-name-input')) {\n            const index = parseInt(e.target.dataset.index);\n            orderState.additionalProducts[index].name = e.target.value;\n            saveData();\n        }\n        \n        // Event listeners para campos básicos\n        if (e.target.id === 'reseller-name') {\n            orderState.resellerName = e.target.value;\n            saveData();\n        }\n        if (e.target.id === 'address') {\n            orderState.address = e.target.value;\n            saveData();\n        }\n        if (e.target.id === 'phone') {\n            orderState.phone = e.target.value;\n            saveData();\n        }\n        if (e.target.id === 'attendance-by') {\n            orderState.attendanceBy = e.target.value;\n            saveData();\n        }\n        if (e.target.id === 'credit-paid') {\n            orderState.creditPaid = parseFloat(e.target.value) || 0;\n            updateSummary();\n            updatePaymentDates();\n            saveData();\n        }\n        if (e.target.id === 'general-discount') {\n            orderState.generalDiscount = parseFloat(e.target.value) || 0;\n            renderProductsTable();\n            updateSummary();\n            updatePaymentDates();\n            saveData();\n        }\n        if (e.target.id === 'freight') {\n            orderState.freight = parseFloat(e.target.value) || 0;\n            updateSummary();\n            updatePaymentDates();\n            saveData();\n        }\n        \n        if (e.target.id === 'transport-select') {\n            orderState.transportOption = e.target.value;\n            updateTransportDisplay();\n            saveData();\n        }\n        \n        // Event listener para Prazo Geral\n        if (e.target.id === 'general-deadline-days') {\n            orderState.generalDeadlineDays = parseInt(e.target.value) || 0;\n            updateGeneralDeadlineDate();\n            updatePaymentDates();\n            saveData();\n        }\n        \n        // MELHORIA 5: Event listener para parcelas do Boleto\n        if (e.target.id === 'installments') {\n            const newInstallments = parseInt(e.target.value) || 1;\n            orderState.installments = Math.max(1, Math.min(12, newInstallments));\n            \n            while (orderState.paymentDays.length < orderState.installments) {\n                orderState.paymentDays.push(0);\n            }\n            orderState.paymentDays = orderState.paymentDays.slice(0, orderState.installments);\n\n            renderPaymentDaysInputs();\n            updatePaymentDates();\n            updateInstallmentsText(); // MELHORIA 5: Atualizar texto\n            updateSummary(); // NOVO: Atualizar valor da parcela do Boleto\n            saveData();\n        }\n        \n        // MELHORIA 5: Event listener para parcelas do Cartão\n        if (e.target.id === 'payment-credit-installments') {\n            const newInstallments = parseInt(e.target.value) || 1;\n            orderState.paymentMethods.credit.installments = Math.max(1, Math.min(12, newInstallments));\n            updateInstallmentsText(); // MELHORIA 5: Atualizar texto\n            updateSummary(); // Atualizar valor da parcela dinamicamente\n            saveData();\n        }\n        \n        if (e.target.id === 'notes') {\n            orderState.notes = e.target.value;\n            saveData();\n        }\n        \n        // Event listeners para formas de pagamento\n        if (e.target.id === 'payment-pix-details') {\n            orderState.paymentMethods.pix.details = e.target.value;\n            saveData();\n        }\n        if (e.target.id === 'payment-transfer-details') {\n            orderState.paymentMethods.transfer.details = e.target.value;\n            saveData();\n        }\n        \n        if (e.target.id === 'product-search') {\n            filterProducts(e.target.value);\n            toggleClearSearchButton(e.target.value);\n        }\n    });\n\n    // Event listeners para checkboxes de pagamento\n    document.addEventListener('change', function(e) {\n        if (e.target.id === 'payment-pix') {\n            orderState.paymentMethods.pix.enabled = e.target.checked;\n            updatePaymentDates(); // Atualizar datas dinamicamente\n            saveData();\n        }\n        if (e.target.id === 'payment-transfer') {\n            orderState.paymentMethods.transfer.enabled = e.target.checked;\n            updatePaymentDates(); // Atualizar datas dinamicamente\n            saveData();\n        }\n        if (e.target.id === 'payment-boleto') {\n            orderState.paymentMethods.boleto.enabled = e.target.checked;\n            updatePaymentDates(); // Atualizar datas dinamicamente\n            saveData();\n        }\n        if (e.target.id === 'payment-credit') {\n            orderState.paymentMethods.credit.enabled = e.target.checked;\n            toggleCreditInstallmentsField(e.target.checked);\n            updatePaymentDates(); // Atualizar datas dinamicamente\n            saveData();\n        }\n        \n        if (e.target.id === 'hide-empty-lines') {\n            toggleEmptyLines(e.target.checked);\n        }\n    });\n\n    // Event listeners para seleção automática de texto nos campos de quantidade e desconto\n    document.addEventListener('focus', function(e) {\n        if (e.target.classList.contains('quantity-input') || \n            e.target.classList.contains('discount-input') ||\n            e.target.classList.contains('additional-product-quantity-input') ||\n            e.target.classList.contains('additional-product-discount-input') ||\n            e.target.id === 'freight' ||\n            e.target.id === 'general-discount') {\n            e.target.select();\n        }\n    }, true);\n\n    // Event listeners para botões\n    document.addEventListener('click', function(e) {\n        if (e.target.id === 'clear-order-btn') {\n            if (confirm('Tem certeza que deseja limpar todos os dados do pedido?')) {\n                clearOrder();\n            }\n        }\n        if (e.target.id === 'clear-quantities-btn') {\n            clearAllQuantities();\n        }\n        if (e.target.id === 'copy-settlement-btn') {\n            copySettlementValue();\n        }\n        if (e.target.id === 'save-order-btn') {\n            saveOrderConsolidated();\n        }\n        if (e.target.id === 'print-order-btn') {\n            if (orderState.resellerName.trim()) {\n                saveOrderToHistory(orderState);\n            }\n            printOrderAsPDF();\n        }\n        if (e.target.id === 'add-new-product-btn') {\n            addNewProduct();\n        }\n        if (e.target.id === 'clear-search-btn') {\n            clearProductSearch();\n        }\n        if (e.target.id === 'clear-quantities-btn') {\n            clearQuantities();\n        }\n        if (e.target.id === 'export-excel-btn') {\n            if (orderState.resellerName.trim()) {\n                saveOrderToHistory(orderState);\n            }\n            exportToExcel();\n        }\n        if (e.target.id === 'expedition-btn') {\n            if (orderState.resellerName.trim()) {\n                saveOrderToHistory(orderState);\n            }\n            printExpeditionAsPDF();\n        }\n        if (e.target.id === 'add-transport-btn') {\n            showAddTransportModal();\n        }\n        if (e.target.id === 'scroll-to-top') {\n            e.preventDefault();\n            e.stopPropagation();\n            scrollToTop();\n        }\n        if (e.target.id === 'scroll-to-bottom') {\n            e.preventDefault();\n            e.stopPropagation();\n            scrollToBottom();\n        }\n    });\n    \n    // Event listeners adicionais para melhor responsividade dos botões de scroll\n    const scrollToTopBtn = document.getElementById('scroll-to-top');\n    const scrollToBottomBtn = document.getElementById('scroll-to-bottom');\n    \n    if (scrollToTopBtn) {\n        scrollToTopBtn.addEventListener('touchstart', function(e) {\n            e.preventDefault();\n            scrollToTop();\n        }, { passive: false });\n    }\n    \n    if (scrollToBottomBtn) {\n        scrollToBottomBtn.addEventListener('touchstart', function(e) {\n            e.preventDefault();\n            scrollToBottom();\n        }, { passive: false });\n    }\n}\n\nfunction updateProductRowCalculations(row, product) {\n    if (!row) return;\n    \n    let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : orderState.generalDiscount;\n    if (product.applyGeneralDiscount === false) {\n        effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n    }\n\n    const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n    const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n    const discountedPriceCell = row.querySelector('.discounted-price');\n    const totalPriceCell = row.querySelector('.total-price');\n    \n    if (discountedPriceCell) discountedPriceCell.textContent = formatCurrency(discountedPrice);\n    if (totalPriceCell) totalPriceCell.textContent = formatCurrency(totalPrice);\n    \n    if (product.quantity > 0) {\n        row.classList.add(\"has-quantity\");\n    } else {\n        row.classList.remove(\"has-quantity\");\n    }\n}\n\nfunction updateAdditionalProductRowCalculations(row, product) {\n    if (!row) return;\n    \n    let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n    const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n    const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n    const discountedPriceCell = row.querySelector('.discounted-price');\n    const totalPriceCell = row.querySelector('.total-price');\n    \n    if (discountedPriceCell) discountedPriceCell.textContent = formatCurrency(discountedPrice);\n    if (totalPriceCell) totalPriceCell.textContent = formatCurrency(totalPrice);\n    \n    if (product.quantity > 0) {\n        row.classList.add(\"has-quantity\");\n    } else {\n        row.classList.remove(\"has-quantity\");\n    }\n}\n\nfunction updateSummary() {\n    const totalQuantity = calculateTotalQuantity();\n    const totalWeight = calculateTotalWeight();\n    const grossValue = calculateGrossValue();\n    const generalDiscountValue = calculateGeneralDiscountValue();\n    const discountedValue = calculateDiscountedValue();\n    const finalValue = calculateFinalValue();\n    const settlementValue = calculateSettlementValue();\n    const profit = calculateProfit();\n\n    const totalQuantityElement = document.getElementById('total-quantity');\n    if (totalQuantityElement) {\n        totalQuantityElement.textContent = totalQuantity;\n    }\n\n    const totalWeightElement = document.getElementById('total-weight');\n    if (totalWeightElement) {\n        totalWeightElement.textContent = `${totalWeight.toFixed(2)} kg (${(totalWeight * 1000).toFixed(0)} g)`;\n    }\n\n    const grossValueEl = document.getElementById('gross-value');\n    if (grossValueEl) grossValueEl.textContent = formatCurrency(grossValue);\n    \n    const generalDiscountValueEl = document.getElementById('general-discount-value');\n    if (generalDiscountValueEl) generalDiscountValueEl.textContent = formatCurrency(generalDiscountValue);\n    \n    const freightValueEl = document.getElementById('freight-value');\n    if (freightValueEl) freightValueEl.textContent = formatCurrency(orderState.freight);\n    \n    const settlementValueEl = document.getElementById('settlement-value');\n    if (settlementValueEl) settlementValueEl.textContent = formatCurrency(settlementValue);\n    \n    const finalValueEl = document.getElementById('final-value');\n    if (finalValueEl) finalValueEl.textContent = formatCurrency(finalValue);\n    \n    const profitValueEl = document.getElementById('profit-value');\n    const profitItemEl = document.getElementById('profit-item');\n    if (profitValueEl) profitValueEl.textContent = formatCurrency(profit);\n    if (profitItemEl) {\n        profitItemEl.style.display = profit > 0 ? 'flex' : 'none';\n    }\n    \n    const creditPaidValueEl = document.getElementById('credit-paid-value');\n    if (creditPaidValueEl) creditPaidValueEl.textContent = formatCurrency(orderState.creditPaid);\n    \n    const discountedValueEl = document.getElementById('discounted-value');\n    if (discountedValueEl) discountedValueEl.textContent = formatCurrency(discountedValue);\n    \n    // Atualizar valor da parcela do Cartao de Credito\n    const creditInstallmentValueEl = document.getElementById('credit-installment-value');\n    if (creditInstallmentValueEl) {\n        const creditInstallments = orderState.paymentMethods.credit.installments || 1;\n        const creditInstallmentValue = settlementValue / creditInstallments;\n        creditInstallmentValueEl.textContent = `de ${formatCurrency(creditInstallmentValue)}`;\n    }\n\n    // Atualizar valor da parcela do Boleto\n    const boletoInstallmentValueEl = document.getElementById('boleto-installment-value');\n    if (boletoInstallmentValueEl) {\n        const boletoInstallments = orderState.installments || 1;\n        const boletoInstallmentValue = settlementValue / boletoInstallments;\n        boletoInstallmentValueEl.textContent = `${formatCurrency(boletoInstallmentValue)}`;\n    }\n}\n\nfunction formatCurrency(value) {\n    return new Intl.NumberFormat(\"pt-BR\", {\n        style: \"currency\",\n        currency: \"BRL\"\n    }).format(value).replace(/\\s/g, \"\"); // Remove espaços em branco (incluindo NBSP)\n}\n\n// Adicionar event listener para o botão de copiar\ndocument.addEventListener(\"click\", function(e) {\n    if (e.target.id === \"copy-settlement-value\") {\n        const settlementValueElement = document.getElementById(\"settlement-value\");\n        if (settlementValueElement) {\n            const valueToCopy = \"Valor do Acerto: \" + settlementValueElement.textContent;\n            navigator.clipboard.writeText(valueToCopy)\n                .then(() => {\n\n                })\n                .catch(err => {\n                    console.error(\"Erro ao copiar: \", err);\n                    alert(\"Erro ao copiar o valor.\");\n                });\n        }\n    }\n});\n\n// MELHORIA 1: Função clearOrder melhorada com data de hoje como padrão\nfunction clearOrder() {\n    // Preservar o campo \"Atendimento por\" (não limpar)\n    const currentAttendanceBy = orderState.attendanceBy;\n    \n    orderState = {\n        resellerName: '',\n        address: '',\n        phone: '',\n        attendanceBy: currentAttendanceBy, // Preservar\n        orderDate: '', // Será preenchido por setCurrentDate()\n        creditPaid: 0,\n        freight: 0,\n        transportOption: '', // Limpar transporte\n        installments: 1,\n        generalDiscount: 0,\n        generalDeadlineDays: 0,\n        paymentDays: [],\n         notes: '',\n        packaging: orderState.packaging.map(pkg => ({ ...pkg, quantity: 0 })), // Limpar apenas a quantidade de caixas\n        paymentMethods: {\n            pix: {\n                enabled: false,\n                details: orderState.paymentMethods.pix.details // Preservar detalhes PIX\n            },\n            transfer: {\n                enabled: false,\n                details: orderState.paymentMethods.transfer.details // Preservar detalhes transferência\n            },\n            boleto: {\n                enabled: false\n            },\n            credit: {\n                enabled: false,\n                installments: 1\n            }\n        },\n        products: products.map(product => ({\n            ...product,\n            quantity: 0,\n            individualDiscount: null,\n            lot: orderState.products.find(p => p.id === product.id)?.lot || ''\n        })),\n        additionalProducts: []\n    };\n\n    // Atualizar campos na interface\n    document.getElementById('reseller-name').value = '';\n    document.getElementById('address').value = '';\n    document.getElementById('phone').value = '';\n    // NÃO limpar attendance-by\n    document.getElementById('order-date').value = ''; // Seru00e1 preenchido por setCurrentDate()\n    document.getElementById('credit-paid').value = 0;\n    document.getElementById('general-discount').value = 0;\n    document.getElementById('general-deadline-days').value = ''; // Limpar Prazo Geral\n    document.getElementById('general-deadline-date').textContent = '(definir prazo)'; // Limpar data do Prazo Geral\n    document.getElementById('freight').value = 0;\n    document.getElementById('transport-select').value = '';\n    document.getElementById('installments').value = 1;\n    document.getElementById('notes').value = '';\n    document.getElementById('product-search').value = '';\n\n    // Limpar checkboxes mas preservar detalhes\n    document.getElementById('payment-pix').checked = false;\n    document.getElementById('payment-transfer').checked = false;\n    document.getElementById('payment-boleto').checked = false;\n    document.getElementById('payment-credit').checked = false;\n    document.getElementById('payment-credit-installments').value = 1;\n\n    renderProductsTable();\n    renderPackagingTable(); // Adicionado para limpar as embalagens\n    renderPaymentDaysInputs();\n    updateSummary();\n    updatePaymentDates();\n    updateInstallmentsText(); // MELHORIA 5: Atualizar texto\n    updateTransportDisplay(); // Atualizar exibição do transporte\n    setCurrentDate(); // Garantir que a data seja preenchida após limpar\n    saveData();\n}\n\nfunction generateFileName() {\n    if (!orderState.resellerName.trim()) {\n        alert('Por favor, informe o nome completo antes de salvar.');\n        return null;\n    }\n    \n    if (!orderState.attendanceBy.trim()) {\n        alert('Por favor, informe o nome do atendente antes de salvar.');\n        return null;\n    }\n\n    // Usar a data do campo \"Data do Pedido\", não a data atual do sistema\n    const orderDateElement = document.getElementById('order-date');\n    let orderDate;\n    \n    if (orderDateElement && orderDateElement.value) {\n        // Garantir que a data seja interpretada corretamente\n        const dateValue = orderDateElement.value;\n        orderDate = new Date(dateValue + 'T00:00:00'); // Adicionar horário para evitar problemas de timezone\n    } else {\n        orderDate = new Date();\n    }\n    \n    const year = orderDate.getFullYear();\n    const month = String(orderDate.getMonth() + 1).padStart(2, '0');\n    const day = String(orderDate.getDate()).padStart(2, '0');\n    \n    // Formato: aaaammdd_AtendimentoPor_NomeDoCliente (preservando espaços)\n    return `${year}${month}${day}_${orderState.attendanceBy.trim()}_${orderState.resellerName.trim()}`;\n}\n\nfunction clearAllQuantities() {\n    // Limpar quantidades dos produtos fixos\n    orderState.products.forEach(product => {\n        product.quantity = 0;\n    });\n\n    // Limpar quantidades dos produtos adicionais\n    orderState.additionalProducts.forEach(product => {\n        product.quantity = 0;\n    });\n\n    // Atualizar a interface\n    renderProductsTable();\n    updateSummary();\n    updatePaymentDates();\n    saveData();\n}\n\nfunction copySettlementValue() {\n    const settlementValueElement = document.getElementById('settlement-value');\n    if (settlementValueElement) {\n        const rawValue = settlementValueElement.textContent.trim();\n        \n        // Calcular data de acerto (data do pedido + prazo geral)\n        const orderDateElement = document.getElementById('order-date');\n        const generalDeadlineDaysInput = document.getElementById('general-deadline-days');\n        \n        let settlementDateText = '';\n        if (orderDateElement && orderDateElement.value && generalDeadlineDaysInput && generalDeadlineDaysInput.value) {\n            const orderDate = new Date(orderDateElement.value + 'T00:00:00');\n            const days = parseInt(generalDeadlineDaysInput.value) || 0;\n            const settlementDate = new Date(orderDate.getTime() + days * 24 * 60 * 60 * 1000);\n            settlementDateText = `\\nAcerto até dia: ${settlementDate.toLocaleDateString('pt-BR')}`;\n        }\n        \n        const textToCopy = `Valor do acerto: ${rawValue}${settlementDateText}`;\n        navigator.clipboard.writeText(textToCopy).then(() => {\n            // Sem alerta de confirmação\n            console.log(`Texto copiado: ${textToCopy}`);\n        }).catch(err => {\n            console.error('Erro ao copiar valor: ', err);\n            alert('Erro ao copiar valor. Tente novamente.');\n        });\n    }\n}\n\nfunction saveOrderAsImage() {\n    const fileName = generateFileName();\n    if (!fileName) return;\n\n    const printContent = createPrintableContent();\n    \n    html2canvas(printContent, {\n        scale: 2,\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff'\n    }).then(canvas => {\n        const link = document.createElement('a');\n        link.download = `${fileName}.jpg`;\n        link.href = canvas.toDataURL('image/jpeg', 0.9);\n        link.click();\n        \n        document.body.removeChild(printContent);\n        console.log('Imagem salva com sucesso!');\n    }).catch(error => {\n        console.error('Erro ao gerar imagem:', error);\n        document.body.removeChild(printContent);\n        alert('Erro ao gerar imagem. Verifique se todas as bibliotecas estão carregadas.');\n    });\n}\n\nfunction printOrderAsPDF() {\n    console.log(\"Botão Expedição/Imprimir clicado. Iniciando geração de PDF...\");\n    const fileName = generateFileName();\n    if (!fileName) return;\n\n    console.log('Iniciando geração de PDF...');\n\n    // Verificar se as bibliotecas estão carregadas\n    if (typeof html2canvas === 'undefined') {\n        alert('Erro: Biblioteca html2canvas não carregada. Recarregue a página e tente novamente.');\n        return;\n    }\n\n    // Verificar jsPDF com múltiplas formas de acesso\n    let jsPDFClass;\n    if (typeof window.jsPDF !== 'undefined') {\n        jsPDFClass = window.jsPDF;\n    } else if (typeof window.jspdf !== 'undefined' && window.jspdf.jsPDF) {\n        jsPDFClass = window.jspdf.jsPDF;\n    } else if (typeof jsPDF !== 'undefined') {\n        jsPDFClass = jsPDF;\n    } else {\n        alert('Erro: Biblioteca jsPDF não carregada. Recarregue a página e tente novamente.');\n        return;\n    }\n\n    const printContent = createPrintableContent();\n    \n    html2canvas(printContent, {\n        scale: 2,\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff',\n        logging: false,\n        width: printContent.scrollWidth,\n        height: printContent.scrollHeight\n    }).then(canvas => {\n        const imgData = canvas.toDataURL('image/png');\n        \n        const pdf = new jsPDFClass('p', 'mm', 'a4');\n        \n        const imgWidth = 210;\n        const pageHeight = 295;\n        const imgHeight = (canvas.height * imgWidth) / canvas.width;\n        let heightLeft = imgHeight;\n        \n        let position = 0;\n        \n        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n        heightLeft -= pageHeight;\n        \n        while (heightLeft >= 0) {\n            position = heightLeft - imgHeight;\n            pdf.addPage();\n            pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);\n            heightLeft -= pageHeight;\n        }\n        \n        pdf.save(`${fileName}.pdf`);\n        document.body.removeChild(printContent);\n        console.log('PDF gerado com sucesso!');\n    }).catch(error => {\n        console.error('Erro ao gerar PDF:', error);\n        document.body.removeChild(printContent);\n        alert('Erro ao gerar PDF: ' + error.message + '. Recarregue a página e tente novamente.');\n    });\n}\n\nfunction createPrintableContent() {\n    const printDiv = document.createElement('div');\n    printDiv.style.cssText = `\\n        position: absolute;\\n        top: -9999px;\\n        left: -9999px;\\n        width: 800px;\\n        background: white;\\n        padding: 20px;\\n        font-family: Arial, sans-serif;\\n        font-size: 12px;\\n        line-height: 1.4;\\n        color: black;\\n    `;\n\n    // Usar a data do campo \"Data do Pedido\", não a data atual do sistema\n    const orderDateElement = document.getElementById('order-date');\n    let orderDate;\n    \n    if (orderDateElement && orderDateElement.value) {\n        // Garantir que a data seja interpretada corretamente\n        const dateValue = orderDateElement.value;\n        orderDate = new Date(dateValue + 'T00:00:00'); // Adicionar horário para evitar problemas de timezone\n    } else {\n        orderDate = new Date();\n    }\n    \n    const formattedOrderDate = orderDate.toLocaleDateString('pt-BR');\n\n    let productsHTML = '';\n    // Usar as funções que já incluem embalagens\n    const totalQuantity = calculateTotalQuantity();\n    const totalWeight = calculateTotalWeight();\n\n    orderState.products.forEach(product => {\n        if (product.quantity > 0) {\n            let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : orderState.generalDiscount;\n            if (product.applyGeneralDiscount === false) {\n                effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n            }\n\n            const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n            const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n            const hasAnyDiscount = checkIfHasAnyDiscount();\n            \n            if (hasAnyDiscount) {\n                productsHTML += `\\n                    <tr>\\n                        <td style=\\\"border: 1px solid #ddd; padding: 8px;\\\">${product.name}</td>\\n                        <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.quantity}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(product.catalogPrice)}</td>\\n                        <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${effectiveDiscount.toFixed(1)}%</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(discountedPrice)}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(totalPrice)}</td>\\n                    </tr>\\n                `;\n            } else {\n                productsHTML += `\\n                    <tr>\\n                        <td style=\\\"border: 1px solid #ddd; padding: 8px;\\\">${product.name}</td>\\n                        <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.quantity}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(product.catalogPrice)}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(totalPrice)}</td>\\n                    </tr>\\n                `;\n            }\n        }\n    });\n\n    orderState.additionalProducts.forEach(product => {\n        if (product.quantity > 0) {\n            let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n            const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n            const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n            const hasAnyDiscount = checkIfHasAnyDiscount();\n            \n            if (hasAnyDiscount) {\n                productsHTML += `\\n                    <tr>\\n                        <td style=\\\"border: 1px solid #ddd; padding: 8px;\\\">${product.name}</td>\\n                        <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.quantity}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(product.catalogPrice)}</td>\\n                        <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${effectiveDiscount.toFixed(1)}%</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(discountedPrice)}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(totalPrice)}</td>\\n                    </tr>\\n                `;\n            } else {\n                productsHTML += `\\n                    <tr>\\n                        <td style=\\\"border: 1px solid #ddd; padding: 8px;\\\">${product.name}</td>\\n                        <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.quantity}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(product.catalogPrice)}</td>\\n                        <td style=\\\"text-align: right; border: 1px solid #ddd; padding: 8px;\\\">${formatCurrency(totalPrice)}</td>\\n                    </tr>\\n                `;\n            }\n        }\n    });\n\n    const hasAnyDiscount = checkIfHasAnyDiscount();\n    const tableHeader = hasAnyDiscount ? `\\n        <tr>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Produto</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Quantidade</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Preço Catálogo</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Desconto (%)</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Preço c/ Desconto</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Total Item</th>\\n        </tr>\\n    ` : `\\n        <tr>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Produto</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Quantidade</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Preço Catálogo</th>\\n            <th style=\\\"border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Total Item</th>\\n        </tr>\\n    `;\n\n    const grossValue = calculateGrossValue();\n    const discountedValue = calculateDiscountedValue();\n    const finalValue = calculateFinalValue();\n    const settlementValue = calculateSettlementValue();\n    const profit = calculateProfit();\n\n    printDiv.innerHTML = `\\n        <div style=\\\"position: relative; height: 80px; margin-bottom: 20px;\\\">\\n            <img src=\\\"LogotipoCW.jpg\\\" alt=\\\"Logo\\\" style=\\\"position: absolute; top: 0; left: 0; max-height: 80px;\\\">\\n            <h2 style=\\\"margin: 0; color: #333; text-align: center; line-height: 80px;\\\">PEDIDO DE VENDAS</h2>\\n        </div>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <p><strong>NOME:</strong> ${orderState.resellerName}</p>\\n            <p><strong>Data do Pedido:</strong> ${formattedOrderDate}</p>\\n            ${orderState.address ? `<p><strong>Endereço:</strong> ${orderState.address}</p>` : ''}\\n            ${orderState.phone ? `<p><strong>Telefone:</strong> ${orderState.phone}</p>` : ''}\\n            ${orderState.attendanceBy ? `<p><strong>Atendimento por:</strong> ${orderState.attendanceBy}</p>` : ''}\\n        </div>\\n\\n        <table style=\\\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\\\">\\n            ${tableHeader}\\n            ${productsHTML}\\n        </table>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <p><strong>Quantidade Total:</strong> ${totalQuantity}</p>\\n            <p><strong>Peso Total:</strong> ${totalWeight.toFixed(2)} kg (${(totalWeight * 1000).toFixed(0)} g)</p>\\n        </div>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <h3 style=\\\"margin-bottom: 10px;\\\">RESUMO DO PEDIDO</h3>\\n            <p><strong>Valor Bruto:</strong> ${formatCurrency(grossValue)}</p>\\n            ${orderState.freight > 0 ? `<p><strong>Frete:</strong> ${formatCurrency(orderState.freight)}${orderState.transportOption ? ` - ${orderState.transportOption}` : ''}</p>` : ''}\\n            ${orderState.creditPaid > 0 ? `<p><strong>Crédito/Pago:</strong> ${formatCurrency(orderState.creditPaid)}</p>` : ''}\\n            <p><strong style=\\\"font-size: 18px; font-weight: 700; color: #dc3545;\\\">Valor do Acerto:</strong> <span style=\\\"font-size: 18px; font-weight: 700; color: #dc3545;\\\">${formatCurrency(settlementValue)}</span></p>\\n            ${profit > 0 ? `<p><strong>Lucro:</strong> ${formatCurrency(profit)}</p>` : ''}\\n        </div>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <h3 style=\\\"margin-bottom: 10px;\\\">Forma de Pagamento</h3>\\n            ${generatePaymentConditionsHTML()}\\n        </div>\\n\n        ${orderState.notes ? `\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <h3 style=\\\"margin-bottom: 10px;\\\">ANOTAÇÕES</h3>\\n            <p>${orderState.notes}</p>\\n        </div>\\n        ` : ''}\\n    `;\n\n    document.body.appendChild(printDiv);\n    return printDiv;\n}\n\nfunction generatePaymentConditionsHTML() {\n    // Usar a data do campo \"Data do Pedido\", não a data atual do sistema\n    const orderDateElement = document.getElementById('order-date');\n    let orderDate;\n    \n    if (orderDateElement && orderDateElement.value) {\n        // Corrigir a interpretação da data\n        const dateValue = orderDateElement.value;\n        // Se o valor está no formato incorreto, tentar corrigir\n        if (dateValue.includes('-') && dateValue.length > 10) {\n            // Formato incorreto detectado, usar data atual como fallback\n            orderDate = new Date();\n        } else {\n            orderDate = new Date(dateValue + 'T00:00:00');\n        }\n    } else {\n        orderDate = new Date();\n    }\n    \n    let html = '';\n    \n    // Adicionar formas de pagamento selecionadas (com ✅)\n    const paymentMethods = [];\n    \n        // Verificar PIX (primeiro)\n    const pixCheckbox = document.querySelector('input[type=\"checkbox\"][id*=\"pix\"]') || document.querySelector('input[type=\"checkbox\"]');\n    if (pixCheckbox && pixCheckbox.checked) {\n        const pixDetails = document.querySelector('input[placeholder*=\"PIX\"]');\n        if (pixDetails && pixDetails.value.trim()) {\n            paymentMethods.push(`PIX: ${pixDetails.value.trim()}`);\n        } else {\n            paymentMethods.push('PIX');\n        }\n    }\n    \n    // Verificar Cartão de Crédito (segundo)\n    const creditCheckbox = document.getElementById('payment-credit');\n    if (creditCheckbox && creditCheckbox.checked) {\n        const creditInstallments = orderState.paymentMethods.credit.installments;\n        const settlementValue = calculateSettlementValue();\n        const creditInstallmentValue = settlementValue / creditInstallments;\n        paymentMethods.push(`Cartão de Crédito: ${creditInstallments} Parcela${creditInstallments > 1 ? 's' : ''} de ${formatCurrency(creditInstallmentValue)}`);\n    }\n\n    // Verificar Transferência Bancária (terceiro)\n    const transferCheckbox = document.querySelectorAll('input[type=\"checkbox\"]')[3];\n    if (transferCheckbox && transferCheckbox.checked) {\n        const transferDetails = document.querySelector('textarea[placeholder*=\"bancários\"]');\n        if (transferDetails && transferDetails.value.trim()) {\n            paymentMethods.push(`Transferência Bancária: ${transferDetails.value.trim()}`);\n        } else {\n            paymentMethods.push('Transferência Bancária');\n        }\n    }\n\n    // Verificar Boleto (quarto)\n    const boletoCheckbox = document.querySelectorAll('input[type=\"checkbox\"]')[2];\n    if (boletoCheckbox && boletoCheckbox.checked) {\n        const installments = orderState.installments;\n        if (installments === 1) {\n            paymentMethods.push('Boleto: 1 Parcela');\n        } else {\n            paymentMethods.push(`Boleto: ${installments} Parcelas`);\n        }\n    }\n    \n    // Exibir formas de pagamento selecionadas\n    if (paymentMethods.length > 0) {\n        html += '<div style=\"margin-bottom: 5px;\">';\n        paymentMethods.forEach(method => {\n            html += `<p><strong>✅ ${method}</strong></p>`;\n        });\n        html += '</div>';\n    }\n    \n    // Verificar se Boleto está selecionado\n    const isBoletoSelected = boletoCheckbox && boletoCheckbox.checked;\n    \n    if (isBoletoSelected) {\n        // Se Boleto: usar prazos específicos do Boleto\n        for (let i = 0; i < orderState.installments; i++) {\n            const days = orderState.paymentDays[i] || 0;\n            const paymentDate = new Date(orderDate.getTime() + days * 24 * 60 * 60 * 1000);\n            const installmentValue = calculateSettlementValue() / orderState.installments;\n            \n            if (orderState.installments === 1) {\n                html += `<p><strong style=\"font-size: 16px; font-weight: 700; color: #dc3545;\">Acerto até dia:</strong> <span style=\"font-size: 16px; font-weight: 700; color: #dc3545;\">${paymentDate.toLocaleDateString('pt-BR')}</span></p>`;\n            } else {\n                html += `<p><strong>${i + 1}ª Parcela ${formatCurrency(installmentValue)} - <span style=\"font-size: 16px; font-weight: 700; color: #dc3545;\">(Acerto até dia):</span></strong> <span style=\"font-size: 16px; font-weight: 700; color: #dc3545;\">${paymentDate.toLocaleDateString('pt-BR')}</span></p>`;\n            }\n        }\n    } else {\n        // Se nenhum Boleto ou se PIX, Cartão ou Transferência: usar Prazo Geral (padrão)\n        const generalDeadlineDays = orderState.generalDeadlineDays || 0;\n        const paymentDate = new Date(orderDate.getTime() + generalDeadlineDays * 24 * 60 * 60 * 1000);\n        html += `<p><strong style=\"font-size: 16px; font-weight: 700; color: #dc3545;\">Acerto até dia:</strong> <span style=\"font-size: 16px; font-weight: 700; color: #dc3545;\">${paymentDate.toLocaleDateString('pt-BR')}</span></p>`;\n    }\n    \n    return html;\n}\n\nfunction formatCurrencyForExcel(value) {\n    // Formatar valor para moeda brasileira no Excel\n    if (typeof value === 'number') {\n        return value.toLocaleString('pt-BR', {\n            style: 'currency',\n            currency: 'BRL',\n            minimumFractionDigits: 2,\n            maximumFractionDigits: 2\n        }).replace(/\\s/g, ''); // Adicionado .replace(/\\s/g, '') para remover espaços em branco (incluindo NBSP)\n    }\n    return value;\n}\n\nfunction exportToExcel() {\n    const fileName = generateFileName();\n    if (!fileName) return;\n\n    try {\n        const data = [];\n        \n        data.push(['PEDIDO DE VENDAS']);\n        data.push([]);\n        data.push(['NOME:', orderState.resellerName]);\n        \n        // Usar a data do campo \"Data do Pedido\", não a data atual do sistema\n        const orderDateElement = document.getElementById('order-date');\n        let orderDate;\n        \n        if (orderDateElement && orderDateElement.value) {\n            // Garantir que a data seja interpretada corretamente\n            const dateValue = orderDateElement.value;\n            orderDate = new Date(dateValue + 'T00:00:00'); // Adicionar horário para evitar problemas de timezone\n        } else {\n            orderDate = new Date();\n        }\n        \n        data.push(['Data do Pedido:', orderDate.toLocaleDateString('pt-BR')]);\n        if (orderState.address) data.push(['Endereço:', orderState.address]);\n        if (orderState.phone) data.push(['Telefone:', orderState.phone]);\n        if (orderState.attendanceBy) data.push(['Atendimento por:', orderState.attendanceBy]);\n        data.push([]);\n        \n        const hasAnyDiscount = checkIfHasAnyDiscount();\n        const productHeader = hasAnyDiscount ? \n            ['Produto', 'Quantidade', 'Preço Catálogo', 'Desconto (%)', 'Preço c/ Desconto', 'Total Item'] :\n            ['Produto', 'Quantidade', 'Preço Catálogo', 'Total Item'];\n        data.push(productHeader);\n        \n        // Usar as funções que já incluem embalagens\n        const totalQuantity = calculateTotalQuantity();\n        const totalWeight = calculateTotalWeight();\n        \n        orderState.products.forEach(product => {\n            if (product.quantity > 0) {\n                let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : orderState.generalDiscount;\n                if (product.applyGeneralDiscount === false) {\n                    effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n                }\n\n                const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n                const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n                const row = hasAnyDiscount ? \n                    [product.name, product.quantity, formatCurrencyForExcel(product.catalogPrice), effectiveDiscount + '%', formatCurrencyForExcel(discountedPrice), formatCurrencyForExcel(totalPrice)] :\n                    [product.name, product.quantity, formatCurrencyForExcel(product.catalogPrice), formatCurrencyForExcel(totalPrice)];\n                data.push(row);\n            }\n        });\n\n        orderState.additionalProducts.forEach(product => {\n            if (product.quantity > 0) {\n                let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n                const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n                const totalPrice = calculateTotalPrice(product.quantity, discountedPrice);\n\n                const row = hasAnyDiscount ? \n                    [product.name, product.quantity, formatCurrencyForExcel(product.catalogPrice), effectiveDiscount + '%', formatCurrencyForExcel(discountedPrice), formatCurrencyForExcel(totalPrice)] :\n                    [product.name, product.quantity, formatCurrencyForExcel(product.catalogPrice), formatCurrencyForExcel(totalPrice)];\n                data.push(row);\n            }\n        });\n\n        data.push([]);\n        data.push(['Quantidade Total:', totalQuantity]);\n        data.push([`Peso Total: ${totalWeight.toFixed(2)} kg (${(totalWeight * 1000).toFixed(0)} g)`]);\n        data.push([]);\n        data.push(['RESUMO DO PEDIDO']);\n        data.push(['Valor Bruto:', formatCurrencyForExcel(calculateGrossValue())]);\n        data.push(['Frete:', formatCurrencyForExcel(orderState.freight)]);\n        data.push(['Transporte:', orderState.transportOption || '']);\n        // 'Valor da Empresa' mantido para cálculos mas não exibido na exportação\n        if (orderState.creditPaid > 0) {\n            data.push(['Crédito/Pago:', formatCurrencyForExcel(orderState.creditPaid)]);\n        }\n        data.push(['Valor do Acerto:', formatCurrencyForExcel(calculateSettlementValue())]);\n        const profit = calculateProfit();\n        if (profit > 0) {\n            data.push(['Lucro:', formatCurrencyForExcel(profit)]);\n        }\n\n        data.push([]);\n        data.push(['Forma de Pagamento']);\n        \n        // Adicionar formas de pagamento selecionadas (com ✅) no Excel\n        const paymentMethods = [];\n        \n        // Verificar PIX\n        const pixCheckbox = document.querySelector(\"input[type=\\\"checkbox\\\"][id*=\\\"pix\\\"]\") || document.querySelector(\"input[type=\\\"checkbox\\\"]\");\n        if (pixCheckbox && pixCheckbox.checked) {\n            const pixDetails = document.querySelector(\"input[placeholder*=\\\"PIX\\\"]\");\n            if (pixDetails && pixDetails.value.trim()) {\n                paymentMethods.push(`✅ PIX: ${pixDetails.value.trim()}`);\n            } else {\n                paymentMethods.push(\"✅ PIX\");\n            }\n        }\n             // Verificar Cartão de Crédito\n        const creditCheckbox = document.getElementById(\"payment-credit\");\n        if (creditCheckbox && creditCheckbox.checked) {\n            const creditInstallments = orderState.paymentMethods.credit.installments;\n            paymentMethods.push(`✅ Cartão de Crédito: ${creditInstallments} Parcela${creditInstallments > 1 ? \"s\" : \"\"}`);\n        }\n\n        // Verificar Transferência Bancária\n        const transferCheckbox = document.getElementById(\"payment-transfer\");\n        if (transferCheckbox && transferCheckbox.checked) {\n            const transferDetails = document.querySelector(\"textarea[placeholder*=\\\"bancários\\\"]\");\n            if (transferDetails && transferDetails.value.trim()) {\n                paymentMethods.push(`✅ Transferência Bancária: ${transferDetails.value.trim()}`);\n            } else {\n                paymentMethods.push(\"✅ Transferência Bancária\");\n            }\n        }\n\n        // Verificar Boleto\n        const boletoCheckbox = document.getElementById(\"payment-boleto\");\n        if (boletoCheckbox && boletoCheckbox.checked) {\n            const installments = orderState.installments;\n            if (installments === 1) {\n                paymentMethods.push(\"✅ Boleto: 1 Parcela\");\n            } else {\n                paymentMethods.push(`✅ Boleto: ${installments} Parcelas`);\n            }\n        }   \n        // Adicionar formas de pagamento ao Excel\n        paymentMethods.forEach(method => {\n            data.push([method]);\n        });\n        \n        // Verificar se Boleto está selecionado\n        const isBoletoSelected = boletoCheckbox && boletoCheckbox.checked;\n        \n        if (isBoletoSelected) {\n            // Se Boleto: usar prazos específicos do Boleto\n            for (let i = 0; i < orderState.installments; i++) {\n                const days = orderState.paymentDays[i] || 0;\n                \n                // Usar a data do campo \"Data do Pedido\", não a data atual do sistema\n                const orderDateElement = document.getElementById('order-date');\n                let orderDate;\n                \n                if (orderDateElement && orderDateElement.value) {\n                    // Corrigir a interpretação da data\n                    const dateValue = orderDateElement.value;\n                    // Se o valor está no formato incorreto, tentar corrigir\n                    if (dateValue.includes('-') && dateValue.length > 10) {\n                        // Formato incorreto detectado, usar data atual como fallback\n                        orderDate = new Date();\n                    } else {\n                        orderDate = new Date(dateValue + 'T00:00:00');\n                    }\n                } else {\n                    orderDate = new Date();\n                }\n                \n                // Corrigir o cálculo: não adicionar +1 dia extra\n                const paymentDate = new Date(orderDate.getTime() + days * 24 * 60 * 60 * 1000);\n                const installmentValue = calculateSettlementValue() / orderState.installments;\n                \n                if (orderState.installments === 1) {\n                    data.push(['Acerto até dia:', paymentDate.toLocaleDateString('pt-BR'), `Prazo: ${generalDeadlineDays} dias`]);\n                } else {\n                    data.push([`${i + 1}ª Parcela:`, formatCurrencyForExcel(installmentValue), `Prazo: ${days} dias`, 'Acerto até dia:', paymentDate.toLocaleDateString('pt-BR')]);\n                }\n            }\n        } else {\n            // Se nenhum Boleto ou se PIX, Cartão ou Transferência: usar Prazo Geral (padrão)\n            const generalDeadlineDays = orderState.generalDeadlineDays || 0;\n            \n            // Usar a data do campo \"Data do Pedido\", não a data atual do sistema\n            const orderDateElement = document.getElementById('order-date');\n            let orderDate;\n            \n            if (orderDateElement && orderDateElement.value) {\n                // Corrigir a interpretação da data\n                const dateValue = orderDateElement.value;\n                // Se o valor está no formato incorreto, tentar corrigir\n                if (dateValue.includes('-') && dateValue.length > 10) {\n                    // Formato incorreto detectado, usar data atual como fallback\n                    orderDate = new Date();\n                } else {\n                    orderDate = new Date(dateValue + 'T00:00:00');\n                }\n            } else {\n                orderDate = new Date();\n            }\n            \n            const paymentDate = new Date(orderDate.getTime() + generalDeadlineDays * 24 * 60 * 60 * 1000);\n            data.push(['Acerto até dia:', paymentDate.toLocaleDateString('pt-BR'), `Prazo: ${generalDeadlineDays} dias`]);\n        }\n\n        if (orderState.notes) {\n            data.push([]);\n            data.push(['ANOTAÇÕES']);\n            data.push([orderState.notes]);\n        }\n\n        const wb = XLSX.utils.book_new();\n        const ws = XLSX.utils.aoa_to_sheet(data);\n        \n        XLSX.utils.book_append_sheet(wb, ws, \"Pedido\");\n        \n        XLSX.writeFile(wb, `${fileName}.xlsx`);\n        \n        console.log('Excel exportado com sucesso!');\n    } catch (error) {\n        console.error('Erro ao exportar Excel:', error);\n        alert('Erro ao exportar para Excel. Verifique se todas as bibliotecas estão carregadas.');\n    }\n}\n\nfunction addNewProduct() {\n    const newProduct = {\n        name: '',\n        catalogPrice: 0,\n        weight: 0.1,\n        quantity: 0,\n        individualDiscount: null,\n        lot: ''\n    };\n    \n    orderState.additionalProducts.push(newProduct);\n    renderProductsTable();\n    saveData();\n}\n\nfunction removeAdditionalProduct(index) {\n    orderState.additionalProducts.splice(index, 1);\n    renderProductsTable();\n    updateSummary();\n    updatePaymentDates();\n    saveData();\n}\n\nfunction normalizeText(text) {\n    if (typeof text !== 'string') return '';\n    return text.normalize('NFD').replace(/[\\u0300-\\u036f]/g, '').toLowerCase();\n}\n\nfunction filterProducts(searchTerm) {\n    if (!searchTerm.trim()) {\n        renderProductsTable();\n        return;\n    }\n\n    const normalizedSearchTerm = normalizeText(searchTerm);\n    const filteredProducts = orderState.products.filter(product => \n        normalizeText(product.name).includes(normalizedSearchTerm)\n    );\n    \n    renderProductsTable(filteredProducts);\n}\n\nfunction toggleClearSearchButton(searchValue) {\n    const clearBtn = document.getElementById('clear-search-btn');\n    if (clearBtn) {\n        if (searchValue.trim()) {\n            clearBtn.classList.add('visible');\n        } else {\n            clearBtn.classList.remove('visible');\n        }\n    }\n}\n\nfunction clearProductSearch() {\n    const searchInput = document.getElementById('product-search');\n    if (searchInput) {\n        searchInput.value = '';\n        filterProducts('');\n        toggleClearSearchButton('');\n        searchInput.focus();\n    }\n}\n\nfunction clearQuantities() {\n    orderState.products.forEach(product => {\n        product.quantity = 0;\n    });\n    \n    orderState.additionalProducts.forEach(product => {\n        product.quantity = 0;\n    });\n    \n    orderState.packaging.forEach(pkg => {\n        pkg.quantity = 0;\n    });\n    \n    renderProductsTable();\n    renderPackagingTable();\n    updateSummary();\n    updatePaymentDates();\n    saveData();\n}\n\n// Funções de cálculo\nfunction calculateDiscountedPrice(catalogPrice, discount) {\n    return catalogPrice * (1 - discount / 100);\n}\n\nfunction calculateTotalPrice(quantity, discountedPrice) {\n    return quantity * discountedPrice;\n}\n\nfunction calculateTotalQuantity() {\n    let total = 0;\n    orderState.products.forEach(product => {\n        total += product.quantity;\n    });\n    orderState.additionalProducts.forEach(product => {\n        total += product.quantity;\n    });\n    return total;\n}\n\nfunction calculateTotalWeight() {\n    let total = 0;\n    orderState.products.forEach(product => {\n        total += product.quantity * (product.weight || 0);\n    });\n    orderState.additionalProducts.forEach(product => {\n        total += product.quantity * (product.weight || 0.1);\n    });\n    // Adicionar peso das embalagens\n    orderState.packaging.forEach(packaging => {\n        total += packaging.quantity * (packaging.weight || 0) / 1000; // Converter gramas para kg\n    });\n    return total;\n}\n\nfunction calculateGrossValue() {\n    let total = 0;\n    orderState.products.forEach(product => {\n        total += product.quantity * product.catalogPrice;\n    });\n    orderState.additionalProducts.forEach(product => {\n        total += product.quantity * product.catalogPrice;\n    });\n    return total;\n}\n\nfunction calculateGeneralDiscountValue() {\n    return calculateGrossValue() * (orderState.generalDiscount / 100);\n}\n\nfunction calculateDiscountedValue() {\n    let total = 0;\n    orderState.products.forEach(product => {\n        let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : orderState.generalDiscount;\n        if (product.applyGeneralDiscount === false) {\n            effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n        }\n        const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n        total += calculateTotalPrice(product.quantity, discountedPrice);\n    });\n    orderState.additionalProducts.forEach(product => {\n        let effectiveDiscount = product.individualDiscount !== null ? product.individualDiscount : 0;\n        const discountedPrice = calculateDiscountedPrice(product.catalogPrice, effectiveDiscount);\n        total += calculateTotalPrice(product.quantity, discountedPrice);\n    });\n    return total + orderState.freight;\n}\n\nfunction calculateFinalValue() {\n    return calculateDiscountedValue();\n}\n\nfunction calculateSettlementValue() {\n    return calculateFinalValue() - orderState.creditPaid;\n}\n\nfunction calculateProfit() {\n    const grossValue = calculateGrossValue();\n    const discountedValue = calculateDiscountedValue();\n    return grossValue - discountedValue;\n}\n\n\n\n// Função para ocultar/mostrar linhas com quantidade vazia ou 0\nfunction toggleEmptyLines(hideEmpty) {\n    const tbody = document.getElementById('products-tbody');\n    if (!tbody) return;\n    \n    const rows = tbody.querySelectorAll('tr');\n    \n    rows.forEach(row => {\n        // Pular a linha do botão \"Adicionar outro item\"\n        if (row.querySelector('#add-new-product-btn')) {\n            return;\n        }\n        \n        // Encontrar o campo de quantidade na linha\n        const quantityInput = row.querySelector('.quantity-input, .additional-product-quantity-input');\n        \n        if (quantityInput) {\n            const quantity = parseFloat(quantityInput.value) || 0;\n            \n            if (hideEmpty && quantity === 0) {\n                row.style.display = 'none';\n            } else {\n                row.style.display = '';\n            }\n        }\n    });\n}\n\n\n// Funções de scroll automático\nfunction scrollToTop() {\n    window.scrollTo({\n        top: 0,\n        behavior: 'smooth'\n    });\n}\n\nfunction scrollToBottom() {\n    window.scrollTo({\n        top: document.body.scrollHeight,\n        behavior: 'smooth'\n    });\n}\n\n// Função específica para expedição com colunas ocultas\nfunction printExpeditionAsPDF() {\n    console.log(\"Botão Expedição clicado. Iniciando geração de PDF com colunas ocultas...\");\n    const fileName = generateFileName();\n    if (!fileName) return;\n\n    console.log('Iniciando geração de PDF para expedição...');\n\n    // Verificar se as bibliotecas estão carregadas\n    if (typeof html2canvas === 'undefined') {\n        alert('Erro: Biblioteca html2canvas não carregada. Recarregue a página e tente novamente.');\n        return;\n    }\n\n    // Verificar jsPDF com múltiplas formas de acesso\n    let jsPDFClass;\n    if (typeof window.jsPDF !== 'undefined') {\n        jsPDFClass = window.jsPDF;\n    } else if (typeof window.jspdf !== 'undefined' && window.jspdf.jsPDF) {\n        jsPDFClass = window.jspdf.jsPDF;\n    } else if (typeof jsPDF !== 'undefined') {\n        jsPDFClass = jsPDF;\n    } else {\n        alert('Erro: Biblioteca jsPDF não carregada. Recarregue a página e tente novamente.');\n        return;\n    }\n\n    const printContent = createExpeditionPrintableContent();\n    \n    html2canvas(printContent, {\n        scale: 2,\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff',\n        logging: false,\n        width: printContent.scrollWidth,\n        height: printContent.scrollHeight\n    }).then(canvas => {\n        const imgData = canvas.toDataURL('image/png');\n        \n        // Configuração específica para A4 com margens de 1cm\n        const pdf = new jsPDFClass('p', 'mm', 'a4');\n        \n        const pdfWidth = 210; // A4 width in mm\n        const pdfHeight = 297; // A4 height in mm\n        const margin = 10; // 1cm margin in mm\n        const imgWidth = pdfWidth - (2 * margin); // 190mm (210 - 20)\n        const imgHeight = (canvas.height * imgWidth) / canvas.width;\n        let heightLeft = imgHeight;\n        \n        let position = margin; // Start at margin position\n        \n        pdf.addImage(imgData, 'PNG', margin, position, imgWidth, imgHeight);\n        heightLeft -= (pdfHeight - (2 * margin)); // Account for top and bottom margins\n        \n        while (heightLeft >= 0) {\n            position = heightLeft - imgHeight + margin;\n            pdf.addPage();\n            pdf.addImage(imgData, 'PNG', margin, position, imgWidth, imgHeight);\n            heightLeft -= (pdfHeight - (2 * margin));\n        }\n        \n        pdf.save(`${fileName}.pdf`);\n        document.body.removeChild(printContent);\n        console.log('PDF de expedição gerado com sucesso!');\n    }).catch(error => {\n        console.error('Erro ao gerar PDF de expedição:', error);\n        document.body.removeChild(printContent);\n        alert('Erro ao gerar PDF: ' + error.message + '. Recarregue a página e tente novamente.');\n    });\n}\n\nfunction generateExpeditionPaymentConditionsHTML() {\n    let html = \"\";\n    const paymentMethods = [];\n\n    if (orderState.paymentMethods.pix.enabled) {\n        paymentMethods.push(`✅ PIX${orderState.paymentMethods.pix.details ? \": \" + orderState.paymentMethods.pix.details : \"\"}`);\n    }\n\n    if (orderState.paymentMethods.credit.enabled) {\n        const installments = orderState.paymentMethods.credit.installments;\n        paymentMethods.push(`✅ Cartão de Crédito: ${installments} Parcela${installments > 1 ? \"s\" : \"\"}`);\n    }\n\n    if (orderState.paymentMethods.transfer.enabled) {\n        paymentMethods.push(`✅ Transferência Bancária${orderState.paymentMethods.transfer.details ? \": \" + orderState.paymentMethods.transfer.details : \"\"}`);\n    }\n\n    if (orderState.paymentMethods.boleto.enabled) {\n        const installments = orderState.installments;\n        if (installments === 1) {\n            paymentMethods.push(`✅ Boleto: 1 Parcela`);\n        } else {\n            paymentMethods.push(`✅ Boleto: ${installments} Parcelas`);\n        }\n    }\n\n    if (paymentMethods.length > 0) {\n        html += `<div style=\\\"margin-bottom: 10px;\\\">`;\n        paymentMethods.forEach(method => {\n            html += `<p>${method}</p>`;\n        });\n        html += `</div>`;\n    }\n\n    return html;\n}\n\n// Função para criar conteúdo imprimível específico para expedição\nfunction createExpeditionPrintableContent() {\n    const printDiv = document.createElement(\"div\");\n    printDiv.style.cssText = `\\n        position: absolute;\\n        top: -9999px;\\n        left: -9999px;\\n        width: 800px;\\n        background: white;\\n        padding: 20px;\\n        font-family: Arial, sans-serif;\\n        font-size: 12px;\\n        line-height: 1.4;\\n        color: black;\\n    `;\n\n    const orderDateElement = document.getElementById(\"order-date\");\n    let orderDate;\n    \n    if (orderDateElement && orderDateElement.value) {\n        const dateValue = orderDateElement.value;\n        orderDate = new Date(dateValue + \"T00:00:00\");\n    } else {\n        orderDate = new Date();\n    }\n    \n    const formattedOrderDate = orderDate.toLocaleDateString(\"pt-BR\");\n\n    let productsHTML = \"\";\n    // Usar as funções que já incluem embalagens\n    const totalQuantity = calculateTotalQuantity();\n    const totalWeight = calculateTotalWeight();\n\n    orderState.products.forEach(product => {\n        if (product.quantity > 0) {\n            productsHTML += `\\n                <tr>\\n                    <td style=\\\"border: 1px solid #ddd; padding: 8px;\\\">${product.name}</td>\\n                    <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.quantity}</td>\\n                    <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.lot || \"\"}</td>\\n                </tr>\\n            `;\n        }\n    });\n\n    orderState.additionalProducts.forEach(product => {\n        if (product.quantity > 0) {\n            productsHTML += `\\n                <tr>\\n                    <td style=\\\"border: 1px solid #ddd; padding: 8px;\\\">${product.name}</td>\\n                    <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.quantity}</td>\\n                    <td style=\\\"text-align: center; border: 1px solid #ddd; padding: 8px;\\\">${product.lot || \"\"}</td>\\n                </tr>\\n            `;\n        }\n    });\n\n    const tableHeader = `\\n        <tr>\\n            <th style=\\\"width: 50%; border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Produto</th>\\n            <th style=\\\"width: 15%; text-align: center; border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Quantidade</th>\\n            <th style=\\\"width: 35%; border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Lote</th>\\n        </tr>\\n    `;\n\n    printDiv.innerHTML = `\\n        <div style=\\\"position: relative; height: 80px; margin-bottom: 20px;\\\">\\n            <img src=\\\"LogotipoCW.jpg\\\" alt=\\\"Logo\\\" style=\\\"position: absolute; top: 0; left: 0; max-height: 80px;\\\">\\n            <h2 style=\\\"margin: 0; color: #333; text-align: center; line-height: 80px;\\\">EXPEDIÇÃO</h2>\\n        </div>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <p><strong>NOME:</strong> ${orderState.resellerName}</p>\\n            <p><strong>Data do Pedido:</strong> ${formattedOrderDate}</p>\\n            ${orderState.address ? `<p><strong>Endereço:</strong> ${orderState.address}</p>` : \"\"}\\n            ${orderState.phone ? `<p><strong>Telefone:</strong> ${orderState.phone}</p>` : \"\"}\\n            ${orderState.attendanceBy ? `<p><strong>Atendimento por:</strong> ${orderState.attendanceBy}</p>` : \"\"}\\n            ${orderState.transportOption ? `<p><strong>Transporte:</strong> ${orderState.transportOption}</p>` : \"\"}\\n        </div>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <h3 style=\\\"margin-bottom: 10px;\\\">PRODUTOS</h3>\\n            <table style=\\\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\\\">\\n                <thead>\\n                    ${tableHeader}\\n                </thead>\\n                <tbody>\\n                    ${productsHTML}\\n                    </tbody>\\n                </table>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <h3 style=\\\"margin-bottom: 10px;\\\">EMBALAGENS DO PEDIDO</h3>\\n            <table style=\\\"width: 100%; border-collapse: collapse; margin-bottom: 20px;\\\">\\n                <thead>\\n                    <tr>\\n                        <th style=\\\"width: 40%; border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Caixa</th>\\n                        <th style=\\\"width: 20%; text-align: center; border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Qtde</th>\\n                        <th style=\\\"width: 20%; text-align: center; border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Peso (g)</th>\\n                        <th style=\\\"width: 20%; text-align: center; border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5;\\\">Peso Total (g)</th>\\n                    </tr>\\n                </thead>\\n                  <tbody>\n                    ${orderState.packaging.filter(pkg => pkg.quantity > 0).map(pkg => `\n                        <tr>\n                            <td style=\"border: 1px solid #ddd; padding: 8px;\">${pkg.name}</td>\n                            <td style=\"text-align: center; border: 1px solid #ddd; padding: 8px;\">${pkg.quantity}</td>\n                            <td style=\"text-align: center; border: 1px solid #ddd; padding: 8px;\">${pkg.weight}</td>\n                            <td style=\"text-align: center; border: 1px solid #ddd; padding: 8px;\">${pkg.quantity * pkg.weight}</td>\n                        </tr>\n                    `).join('')}\n                </tbody>\n            </table>\n        </div>\\n\\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <p><strong>Quantidade Total:</strong> ${totalQuantity}</p>\\n            <p><strong>Peso Total:</strong> ${totalWeight.toFixed(2)} kg (${(totalWeight * 1000).toFixed(0)} g)</p>\\n        </div>\\n\n        ${orderState.notes ? `     <div style=\\\"margin-bottom: 20px;\\\">\\n            <h3 style=\\\"margin-bottom: 10px;\\\">ANOTAÇÕES</h3>\\n            <p>${orderState.notes}</p>\\n        </div>\\n        ` : \"\"}\n\n        <div style=\\\"margin-bottom: 20px;\\\">\\n            <h3 style=\\\"margin-bottom: 10px;\\\">FORMA DE PAGAMENTO</h3>\\n            ${generateExpeditionPaymentConditionsHTML()}\\n        </div>\\n    `;\n\n    document.body.appendChild(printDiv);\n    return printDiv;\n}\n\n\n\n// Funções para gerenciar embalagens\nfunction renderPackagingTable() {\n    const tbody = document.getElementById(\"packaging-tbody\");\n    if (!tbody) {\n        console.error(\"renderPackagingTable: Elemento packaging-tbody não encontrado\");\n        return;\n    }\n    \n    tbody.innerHTML = \"\";\n    \n    orderState.packaging.forEach((packaging, index) => {\n        const row = createPackagingRow(packaging, index);\n        tbody.appendChild(row);\n    });\n\n    // Adicionar linha inicial se não houver embalagens\n    if (orderState.packaging.length === 0) {\n        addNewPackaging();\n    }\n}\n\nfunction createPackagingRow(packaging, index) {\n    const row = document.createElement(\"tr\");\n    \n    const totalWeight = packaging.quantity * (packaging.weight || 0);\n    \n    row.innerHTML = `\\n        <td>\\n            <input type=\\\"text\\\" \\n                   value=\\\"${packaging.name || ''}\\\" \\n                   data-packaging-index=\\\"${index}\\\" \\n                   data-field=\\\"name\\\" \\n                   class=\\\"packaging-name-input\\\" \\n                   placeholder=\\\"Nome da caixa\\\">\\n        </td>\\n        <td>\\n            <input type=\\\"number\\\" \\n                   value=\\\"${packaging.quantity || ''}\\\" \\n                   data-packaging-index=\\\"${index}\\\" \\n                   data-field=\\\"quantity\\\" \\n                   class=\\\"packaging-quantity-input\\\" \\n                   min=\\\"0\\\" \\n                   step=\\\"1\\\" \\n                   placeholder=\\\"0\\\">\\n        </td>\\n        <td>\\n            <input type=\\\"number\\\" \\n                   value=\\\"${packaging.weight || ''}\\\" \\n                   data-packaging-index=\\\"${index}\\\" \\n                   data-field=\\\"weight\\\" \\n                   class=\\\"packaging-weight-input\\\" \\n                   min=\\\"0\\\" \\n                   step=\\\"1\\\" \\n                   placeholder=\\\"0\\\">\\n        </td>\\n        <td>\\n            <span class=\\\"packaging-weight-total\\\">${totalWeight.toFixed(0)}</span>\\n            <button class=\\\"remove-packaging-btn\\\" data-packaging-index=\\\"${index}\\\">×</button>\\n        </td>\\n    `;\n    \n    return row;\n}\n\nfunction addNewPackaging() {\n    orderState.packaging.push({\n        name: '',\n        quantity: 0,\n        weight: 0\n    });\n    renderPackagingTable();\n    saveData();\n}\n\nfunction removePackaging(index) {\n    orderState.packaging.splice(index, 1);\n    renderPackagingTable();\n    updateSummary();\n    saveData();\n}\n\nfunction updatePackaging(index, field, value) {\n    if (orderState.packaging[index]) {\n        if (field === 'quantity' || field === 'weight') {\n            orderState.packaging[index][field] = parseFloat(value) || 0;\n        } else {\n            orderState.packaging[index][field] = value;\n        }\n        \n        // Atualizar o peso total da linha\n        const totalWeight = orderState.packaging[index].quantity * (orderState.packaging[index].weight || 0);\n        const weightTotalElement = document.querySelector(`[data-packaging-index=\\\"${index}\\\"]`).closest('tr').querySelector('.packaging-weight-total');\n        if (weightTotalElement) {\n            weightTotalElement.textContent = totalWeight.toFixed(0);\n        }\n        \n        updateSummary();\n        saveData();\n    }\n}\n\n// Adicionar event listeners para embalagens\ndocument.addEventListener('input', function(e) {\n    if (e.target.classList.contains('packaging-name-input') || \n        e.target.classList.contains('packaging-quantity-input') || \n        e.target.classList.contains('packaging-weight-input')) {\n        const index = parseInt(e.target.dataset.packagingIndex);\n        const field = e.target.dataset.field;\n        updatePackaging(index, field, e.target.value);\n    }\n});\n\ndocument.addEventListener('click', function(e) {\n    if (e.target.id === 'add-new-packaging-btn') {\n        addNewPackaging();\n    }\n    \n    if (e.target.classList.contains('remove-packaging-btn')) {\n        const index = parseInt(e.target.dataset.packagingIndex);\n        removePackaging(index);\n    }\n});\n\n\n\n// Funções para gerenciar transporte\nfunction updateTransportDisplay() {\n    const transportDisplay = document.getElementById('transport-display');\n    if (transportDisplay) {\n        transportDisplay.textContent = orderState.transportOption || '';\n    }\n}\n\nfunction showAddTransportModal() {\n    // Criar modal\n    const modal = document.createElement('div');\n    modal.className = 'transport-modal';\n    modal.innerHTML = `\\n        <div class=\\\"transport-modal-content\\\">\\n            <h3>Adicionar Nova Opção de Transporte</h3>\\n            <input type=\\\"text\\\" id=\\\"new-transport-input\\\" class=\\\"modern-input\\\" placeholder=\\\"Digite a nova opção de transporte\\\" maxlength=\\\"50\\\">\\n            <div class=\\\"transport-modal-buttons\\\">\\n                <button class=\\\"btn btn-secondary\\\" onclick=\\\"closeTransportModal()\\\">Cancelar</button>\\n                <button class=\\\"btn btn-primary\\\" onclick=\\\"addNewTransportOption()\\\">Adicionar</button>\\n            </div>\\n        </div>\\n    `;\n    \n    document.body.appendChild(modal);\n    \n    // Focar no input\n    const input = document.getElementById('new-transport-input');\n    if (input) {\n        input.focus();\n        \n        // Adicionar event listener para Enter\n        input.addEventListener('keypress', function(e) {\n            if (e.key === 'Enter') {\n                addNewTransportOption();\n            }\n        });\n    }\n    \n    // Fechar modal ao clicar fora\n    modal.addEventListener('click', function(e) {\n        if (e.target === modal) {\n            closeTransportModal();\n        }\n    });\n}\n\nfunction closeTransportModal() {\n    const modal = document.querySelector('.transport-modal');\n    if (modal) {\n        document.body.removeChild(modal);\n    }\n}\n\nfunction addNewTransportOption() {\n    const input = document.getElementById('new-transport-input');\n    if (!input) return;\n    \n    const newOption = input.value.trim();\n    if (!newOption) {\n        alert('Por favor, digite uma opção de transporte válida.');\n        return;\n    }\n    \n    // Verificar se a opção já existe\n    const select = document.getElementById('transport-select');\n    const existingOptions = Array.from(select.options).map(option => option.value.toLowerCase());\n    \n    if (existingOptions.includes(newOption.toLowerCase())) {\n        alert('Esta opção de transporte já existe.');\n        return;\n    }\n    \n    // Adicionar nova opção ao select\n    const option = document.createElement('option');\n    option.value = newOption;\n    option.textContent = newOption;\n    select.appendChild(option);\n    \n    // Selecionar a nova opção\n    select.value = newOption;\n    orderState.transportOption = newOption;\n    updateTransportDisplay();\n    saveData();\n    \n    // Fechar modal\n    closeTransportModal();\n}\n\n// Inicializar exibição do transporte na inicialização\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Aguardar um pouco para garantir que tudo foi carregado\n    setTimeout(function() {\n        updateTransportDisplay();\n    }, 100);\n});\n\n\n\n\n\n\n\n// ===== HISTÓRICO DE PEDIDOS =====\nconst HISTORY_STORAGE_KEY = 'pedidos-historico';\n\nfunction getOrderHistory() {\n    const history = localStorage.getItem(HISTORY_STORAGE_KEY);\n    return history ? JSON.parse(history) : [];\n}\n\nfunction saveOrderToHistory(orderData) {\n    const history = getOrderHistory();\n    const timestamp = new Date().toISOString();\n    \n    const historyEntry = {\n        id: timestamp,\n        timestamp: timestamp,\n        date: orderData.orderDate || new Date().toISOString().split('T')[0],\n        resellerName: orderData.resellerName,\n        attendanceBy: orderData.attendanceBy,\n        finalValue: calculateFinalValue(),\n        profit: calculateProfit(),\n        settlementValue: calculateSettlementValue(),\n        totalQuantity: calculateTotalQuantity(),\n        orderData: JSON.parse(JSON.stringify(orderData)) // Deep copy\n    };\n    \n    history.unshift(historyEntry); // Adicionar no início\n    localStorage.setItem(HISTORY_STORAGE_KEY, JSON.stringify(history));\n    \n    return historyEntry;\n}\n\nfunction deleteOrderFromHistory(id) {\n    const history = getOrderHistory();\n    const filteredHistory = history.filter(item => item.id !== id);\n    localStorage.setItem(HISTORY_STORAGE_KEY, JSON.stringify(filteredHistory));\n}\n\nfunction loadOrderFromHistory(id) {\n    const history = getOrderHistory();\n    const entry = history.find(item => item.id === id);\n    \n    if (entry) {\n        orderState = JSON.parse(JSON.stringify(entry.orderData));\n        renderProductsTable();\n        renderPackagingTable();\n        updateSummary();\n        updatePaymentDates();\n        renderPaymentDaysInputs();\n        updateInstallmentsText();\n        \n        // Atualizar campos da interface\n        document.getElementById('reseller-name').value = orderState.resellerName;\n        document.getElementById('address').value = orderState.address;\n        document.getElementById('phone').value = orderState.phone;\n        document.getElementById('attendance-by').value = orderState.attendanceBy;\n        document.getElementById('order-date').value = orderState.orderDate;\n        document.getElementById('freight').value = orderState.freight;\n        document.getElementById('general-discount').value = orderState.generalDiscount;\n        document.getElementById('credit-paid').value = orderState.creditPaid;\n        document.getElementById('notes').value = orderState.notes;\n        document.getElementById('transport-select').value = orderState.transportOption;\n        document.getElementById('general-deadline-days').value = orderState.generalDeadlineDays;\n        document.getElementById('installments').value = orderState.installments;\n        document.getElementById('payment-credit-installments').value = orderState.paymentMethods.credit.installments;\n        \n        // Atualizar checkboxes de pagamento\n        document.getElementById('payment-pix').checked = orderState.paymentMethods.pix.enabled;\n        document.getElementById('payment-credit').checked = orderState.paymentMethods.credit.enabled;\n        document.getElementById('payment-boleto').checked = orderState.paymentMethods.boleto.enabled;\n        document.getElementById('payment-transfer').checked = orderState.paymentMethods.transfer.enabled;\n        \n        document.getElementById('payment-pix-details').value = orderState.paymentMethods.pix.details;\n        document.getElementById('payment-transfer-details').value = orderState.paymentMethods.transfer.details;\n        \n        updateGeneralDeadlineDate();\n        updateTransportDisplay();\n        saveData();\n        \n        closeHistoryModal();\n        scrollToTop();\n    }\n}\n\n// ===== SALVAMENTO CONSOLIDADO =====\nfunction saveOrderConsolidated() {\n    // Validar dados básicos\n    if (!orderState.resellerName.trim()) {\n        alert('Por favor, preencha o nome do cliente antes de salvar.');\n        document.getElementById('reseller-name').focus();\n        return;\n    }\n    \n    // Salvar no histórico\n    saveOrderToHistory(orderState);\n    \n    // Gerar JPEG\n    saveOrderAsImage();\n    \n    alert('Pedido salvo no histórico e exportado como imagem com sucesso!');\n}\n\n// ===== ATALHOS DE TECLADO =====\nfunction setupKeyboardShortcuts() {\n    document.addEventListener('keydown', function(e) {\n        // Ctrl+S ou Cmd+S para salvar\n        if ((e.ctrlKey || e.metaKey) && e.key === 's') {\n            e.preventDefault();\n            saveOrderConsolidated();\n        }\n        \n        // Delete para limpar valor em campos de quantidade/desconto\n        if (e.key === 'Delete') {\n            const activeElement = document.activeElement;\n            if (activeElement && (activeElement.classList.contains('quantity-input') || \n                                   activeElement.classList.contains('discount-input') ||\n                                   activeElement.classList.contains('additional-product-quantity-input') ||\n                                   activeElement.classList.contains('additional-product-discount-input'))) {\n                activeElement.value = '';\n                activeElement.dispatchEvent(new Event('input', { bubbles: true }));\n            }\n        }\n        \n        // Enter para confirmar em campos de quantidade/desconto\n        if (e.key === 'Enter') {\n            const activeElement = document.activeElement;\n            if (activeElement && (activeElement.classList.contains('quantity-input') || \n                                   activeElement.classList.contains('discount-input') ||\n                                   activeElement.classList.contains('additional-product-quantity-input') ||\n                                   activeElement.classList.contains('additional-product-discount-input'))) {\n                // Mover para o próximo campo\n                const inputs = Array.from(document.querySelectorAll('.quantity-input, .discount-input, .additional-product-quantity-input, .additional-product-discount-input'));\n                const currentIndex = inputs.indexOf(activeElement);\n                if (currentIndex < inputs.length - 1) {\n                    inputs[currentIndex + 1].focus();\n                    inputs[currentIndex + 1].select();\n                }\n            }\n        }\n    });\n}\n\n// Realce de linha em edição\nfunction setupRowHighlight() {\n    const table = document.getElementById('products-tbody');\n    if (!table) return;\n    \n    table.addEventListener('focus', function(e) {\n        if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') {\n            const row = e.target.closest('tr');\n            if (row) {\n                // Remover destaque de outras linhas\n                document.querySelectorAll('.products-table tbody tr.active-row').forEach(r => {\n                    r.classList.remove('active-row');\n                });\n                // Adicionar destaque à linha atual\n                row.classList.add('active-row');\n            }\n        }\n    }, true);\n    \n    table.addEventListener('blur', function(e) {\n        if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') {\n            const row = e.target.closest('tr');\n            if (row) {\n                row.classList.remove('active-row');\n            }\n        }\n    }, true);\n}\n\n// ===== MODAL DE HISTÓRICO =====\nfunction openHistoryModal() {\n    const modal = document.getElementById('history-modal');\n    if (modal) {\n        modal.classList.add('show');\n        renderHistoryList();\n    }\n}\n\nfunction closeHistoryModal() {\n    const modal = document.getElementById('history-modal');\n    if (modal) {\n        modal.classList.remove('show');\n    }\n}\n\nfunction renderHistoryList(searchTerm = '', filterType = '') {\n    const historyList = document.getElementById('history-list');\n    if (!historyList) return;\n    \n    let history = getOrderHistory();\n    \n    // Aplicar filtro de data\n    if (filterType) {\n        // Obter a data de hoje no formato YYYY-MM-DD no fuso local\n        const now = new Date();\n        const todayStr = now.getFullYear() + '-' + \n                        String(now.getMonth() + 1).padStart(2, '0') + '-' + \n                        String(now.getDate()).padStart(2, '0');\n        \n        history = history.filter(item => {\n            // Usar timestamp se date não estiver disponível\n            let dateToCheck = item.date;\n            if (!dateToCheck && item.timestamp) {\n                // Converter timestamp ISO para data no formato YYYY-MM-DD\n                const ts = new Date(item.timestamp);\n                dateToCheck = ts.getFullYear() + '-' + \n                             String(ts.getMonth() + 1).padStart(2, '0') + '-' + \n                             String(ts.getDate()).padStart(2, '0');\n            }\n            \n            if (!dateToCheck) return false;\n            \n            // Normalizar a data para comparar (remover hora se houver)\n            const itemDateStr = dateToCheck.split('T')[0];\n            \n            switch (filterType) {\n                case 'today':\n                    return itemDateStr === todayStr;\n                case 'week':\n                    const weekAgo = new Date(now);\n                    weekAgo.setDate(weekAgo.getDate() - 7);\n                    const weekAgoStr = weekAgo.getFullYear() + '-' + \n                                     String(weekAgo.getMonth() + 1).padStart(2, '0') + '-' + \n                                     String(weekAgo.getDate()).padStart(2, '0');\n                    return itemDateStr >= weekAgoStr;\n                case 'month':\n                    const monthAgo = new Date(now);\n                    monthAgo.setMonth(monthAgo.getMonth() - 1);\n                    const monthAgoStr = monthAgo.getFullYear() + '-' + \n                                       String(monthAgo.getMonth() + 1).padStart(2, '0') + '-' + \n                                       String(monthAgo.getDate()).padStart(2, '0');\n                    return itemDateStr >= monthAgoStr;\n                default:\n                    return true;\n            }\n        });\n    }\n    \n    // Aplicar busca\n    if (searchTerm) {\n        const normalizedSearch = normalizeText(searchTerm);\n        history = history.filter(item => {\n            return normalizeText(item.resellerName).includes(normalizedSearch) ||\n                   normalizeText(item.attendanceBy).includes(normalizedSearch) ||\n                   item.date.includes(searchTerm);\n        });\n    }\n    \n    if (history.length === 0) {\n        historyList.innerHTML = '<div class=\"history-empty\">Nenhum pedido encontrado</div>';\n        return;\n    }\n    \n    historyList.innerHTML = history.map(item => `\n        <div class=\"history-item\" data-history-id=\"${item.id}\">\n            <div class=\"history-item-header\">\n                <span class=\"history-item-title\">${item.resellerName}</span>\n                <span class=\"history-item-date\">${new Date(item.timestamp).toLocaleString('pt-BR')}</span>\n            </div>\n            <div class=\"history-item-details\">\n                <div><strong>Atendente:</strong> ${item.attendanceBy}</div>\n                <div><strong>Data:</strong> ${new Date(item.date).toLocaleDateString('pt-BR')}</div>\n                <div><strong>Valor:</strong> ${formatCurrency(item.finalValue)}</div>\n            </div>\n            <div class=\"history-item-actions\">\n                <button class=\"btn btn-primary history-load-btn\" data-id=\"${item.id}\">📂 Carregar</button>\n                <button class=\"btn btn-danger history-delete-btn\" data-id=\"${item.id}\">🗑️ Deletar</button>\n            </div>\n        </div>\n    `).join('');\n    \n    // Adicionar event listeners para os botões\n    document.querySelectorAll('.history-load-btn').forEach(btn => {\n        btn.addEventListener('click', function() {\n            loadOrderFromHistory(this.dataset.id);\n        });\n    });\n    \n    document.querySelectorAll('.history-delete-btn').forEach(btn => {\n        btn.addEventListener('click', function() {\n            deleteHistoryItem(this.dataset.id);\n        });\n    });\n}\n\nfunction deleteHistoryItem(id) {\n    if (confirm('Tem certeza que deseja deletar este pedido do histórico?')) {\n        deleteOrderFromHistory(id);\n        renderHistoryList();\n        const dashboardModal = document.getElementById('dashboard-modal');\n        if (dashboardModal && dashboardModal.classList.contains('show')) {\n            updateDashboard('all');\n        }\n    }\n}\n\n// ===== MODAL DE DASHBOARD =====\nfunction openDashboardModal() {\n    const modal = document.getElementById('dashboard-modal');\n    if (modal) {\n        modal.classList.add('show');\n        updateDashboard('all');\n    }\n}\n\nfunction closeDashboardModal() {\n    const modal = document.getElementById('dashboard-modal');\n    if (modal) {\n        modal.classList.remove('show');\n    }\n}\n\nfunction updateDashboard(period = 'all') {\n    let history = getOrderHistory();\n    \n    // Filtrar por período\n    if (period !== 'all') {\n        // Obter a data de hoje no formato YYYY-MM-DD no fuso local\n        const now = new Date();\n        const todayStr = now.getFullYear() + '-' + \n                        String(now.getMonth() + 1).padStart(2, '0') + '-' + \n                        String(now.getDate()).padStart(2, '0');\n        \n        history = history.filter(item => {\n            // Usar timestamp se date não estiver disponível\n            let dateToCheck = item.date;\n            if (!dateToCheck && item.timestamp) {\n                // Converter timestamp ISO para data no formato YYYY-MM-DD\n                const ts = new Date(item.timestamp);\n                dateToCheck = ts.getFullYear() + '-' + \n                             String(ts.getMonth() + 1).padStart(2, '0') + '-' + \n                             String(ts.getDate()).padStart(2, '0');\n            }\n            \n            if (!dateToCheck) return false;\n            \n            // Normalizar a data para comparar (remover hora se houver)\n            const itemDateStr = dateToCheck.split('T')[0];\n            \n            switch (period) {\n                case 'today':\n                    return itemDateStr === todayStr;\n                case 'week':\n                    const weekAgo = new Date(now);\n                    weekAgo.setDate(weekAgo.getDate() - 7);\n                    const weekAgoStr = weekAgo.getFullYear() + '-' + \n                                     String(weekAgo.getMonth() + 1).padStart(2, '0') + '-' + \n                                     String(weekAgo.getDate()).padStart(2, '0');\n                    return itemDateStr >= weekAgoStr;\n                case 'month':\n                    const monthAgo = new Date(now);\n                    monthAgo.setMonth(monthAgo.getMonth() - 1);\n                    const monthAgoStr = monthAgo.getFullYear() + '-' + \n                                       String(monthAgo.getMonth() + 1).padStart(2, '0') + '-' + \n                                       String(monthAgo.getDate()).padStart(2, '0');\n                    return itemDateStr >= monthAgoStr;\n                default:\n                    return true;\n            }\n        });\n    }\n    \n    // Calcular métricas\n    const totalSales = history.reduce((sum, item) => sum + item.finalValue, 0);\n    const totalProfit = history.reduce((sum, item) => sum + item.profit, 0);\n    const orderCount = history.length;\n    const avgTicket = orderCount > 0 ? totalSales / orderCount : 0;\n    \n    // Atualizar cards\n    document.getElementById('dashboard-total-sales').textContent = formatCurrency(totalSales);\n    document.getElementById('dashboard-order-count').textContent = orderCount;\n    document.getElementById('dashboard-avg-ticket').textContent = formatCurrency(avgTicket);\n    document.getElementById('dashboard-total-profit').textContent = formatCurrency(totalProfit);\n    \n    // Atualizar gráficos\n    updateSalesChart(history);\n    updateProductsChart(history);\n}\n\nfunction updateSalesChart(history) {\n    const ctx = document.getElementById('sales-chart');\n    if (!ctx) return;\n    \n    // Agrupar vendas por data\n    const salesByDate = {};\n    history.forEach(item => {\n        const date = new Date(item.date).toLocaleDateString('pt-BR');\n        salesByDate[date] = (salesByDate[date] || 0) + item.finalValue;\n    });\n    \n    const labels = Object.keys(salesByDate).reverse();\n    const data = labels.map(label => salesByDate[label]);\n    \n    // Destruir gráfico anterior se existir\n    if (window.salesChart) {\n        window.salesChart.destroy();\n    }\n    \n    window.salesChart = new Chart(ctx, {\n        type: 'line',\n        data: {\n            labels: labels,\n            datasets: [{\n                label: 'Vendas (R$)',\n                data: data,\n                borderColor: '#28a745',\n                backgroundColor: 'rgba(40, 167, 69, 0.1)',\n                tension: 0.4,\n                fill: true\n            }]\n        },\n        options: {\n            responsive: true,\n            maintainAspectRatio: true,\n            plugins: {\n                legend: {\n                    display: true,\n                    position: 'top'\n                }\n            },\n            scales: {\n                y: {\n                    beginAtZero: true,\n                    ticks: {\n                        callback: function(value) {\n                            return 'R$ ' + value.toFixed(2);\n                        }\n                    }\n                }\n            }\n        }\n    });\n}\n\nfunction updateProductsChart(history) {\n    const ctx = document.getElementById('products-chart');\n    if (!ctx) return;\n    \n    // Contar quantidade de produtos vendidos\n    const productSales = {};\n    history.forEach(item => {\n        item.orderData.products.forEach(product => {\n            if (product.quantity > 0) {\n                productSales[product.name] = (productSales[product.name] || 0) + product.quantity;\n            }\n        });\n        item.orderData.additionalProducts.forEach(product => {\n            if (product.quantity > 0) {\n                productSales[product.name] = (productSales[product.name] || 0) + product.quantity;\n            }\n        });\n    });\n    \n    // Ordenar e pegar top 10\n    const sorted = Object.entries(productSales)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 10);\n    \n    const labels = sorted.map(item => item[0].substring(0, 20) + (item[0].length > 20 ? '...' : ''));\n    const data = sorted.map(item => item[1]);\n    \n    // Destruir gráfico anterior se existir\n    if (window.productsChart) {\n        window.productsChart.destroy();\n    }\n    \n    window.productsChart = new Chart(ctx, {\n        type: 'bar',\n        data: {\n            labels: labels,\n            datasets: [{\n                label: 'Quantidade Vendida',\n                data: data,\n                backgroundColor: '#28a745',\n                borderColor: '#218838',\n                borderWidth: 1\n            }]\n        },\n        options: {\n            indexAxis: 'y',\n            responsive: true,\n            maintainAspectRatio: true,\n            plugins: {\n                legend: {\n                    display: true,\n                    position: 'top'\n                }\n            },\n            scales: {\n                x: {\n                    beginAtZero: true,\n                    ticks: {\n                        stepSize: 1\n                    }\n                }\n            }\n        }\n    });\n}\n\n// ===== INICIALIZAÇÃO =====\n// Modificar a função saveOrderAsImage para usar o salvamento consolidado\nconst originalSaveOrderAsImage = saveOrderAsImage;\nsaveOrderAsImage = function() {\n    const fileName = generateFileName();\n    if (!fileName) return;\n\n    const printContent = createPrintableContent();\n    \n    html2canvas(printContent, {\n        scale: 2,\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff'\n    }).then(canvas => {\n        const link = document.createElement('a');\n        link.download = `${fileName}.jpg`;\n        link.href = canvas.toDataURL('image/jpeg', 0.9);\n        link.click();\n        \n        document.body.removeChild(printContent);\n        console.log('Imagem salva com sucesso!');\n    }).catch(error => {\n        console.error('Erro ao gerar imagem:', error);\n        document.body.removeChild(printContent);\n        alert('Erro ao gerar imagem. Verifique se todas as bibliotecas estão carregadas.');\n    });\n};\n\n// Adicionar event listeners para os botões de histórico e dashboard\ndocument.addEventListener('DOMContentLoaded', function() {\n    const historyBtn = document.getElementById('history-btn');\n    const dashboardBtn = document.getElementById('dashboard-btn');\n    const historyModalClose = document.getElementById('history-modal-close');\n    const dashboardModalClose = document.getElementById('dashboard-modal-close');\n    const historySearch = document.getElementById('history-search');\n    const historyFilter = document.getElementById('history-filter');\n    const dashboardPeriod = document.getElementById('dashboard-period');\n    \n    if (historyBtn) {\n        historyBtn.addEventListener('click', openHistoryModal);\n    }\n    \n    if (dashboardBtn) {\n        dashboardBtn.addEventListener('click', openDashboardModal);\n    }\n    \n    if (historyModalClose) {\n        historyModalClose.addEventListener('click', closeHistoryModal);\n    }\n    \n    if (dashboardModalClose) {\n        dashboardModalClose.addEventListener('click', closeDashboardModal);\n    }\n    \n    if (historySearch) {\n        historySearch.addEventListener('input', function() {\n            renderHistoryList(this.value, document.getElementById('history-filter').value);\n        });\n    }\n    \n    if (historyFilter) {\n        historyFilter.addEventListener('change', function() {\n            renderHistoryList(document.getElementById('history-search').value, this.value);\n        });\n    }\n    \n    if (dashboardPeriod) {\n        dashboardPeriod.addEventListener('change', function() {\n            updateDashboard(this.value);\n        });\n    }\n    \n    // Fechar modais ao clicar fora deles\n    const historyModal = document.getElementById('history-modal');\n    const dashboardModal = document.getElementById('dashboard-modal');\n    \n    if (historyModal) {\n        historyModal.addEventListener('click', function(e) {\n            if (e.target === this) {\n                closeHistoryModal();\n            }\n        });\n    }\n    \n    if (dashboardModal) {\n        dashboardModal.addEventListener('click', function(e) {\n            if (e.target === this) {\n                closeDashboardModal();\n            }\n        });\n    }\n    \n    // Inicializar atalhos de teclado e realce de linha\n    setupKeyboardShortcuts();\n    setupRowHighlight();\n});\n\n// Botão de salvar já configurado no event listener principal (linha 711-713)\n"],"names":["products","STORAGE_KEY","orderState","product","initializeApp","loadSavedData","setCurrentDate","renderProductsTable","renderPackagingTable","setupEventListeners","updateSummary","updatePaymentDates","renderPaymentDaysInputs","updateInstallmentsText","creditCheckbox","toggleCreditInstallmentsField","show","creditDetails","orderDateElement","now","brasiliaOffset","utc","brasiliaTime","year","month","day","formattedDate","updateGeneralDeadlineDate","generalDeadlineDateElement","generalDeadlineDaysInput","orderDate","days","deadlineDate","container","i","dayItem","paymentDate","boletoLabel","installmentsInput","count","creditLabel","creditInput","dateValue","installmentsDetails","settlementValue","calculateSettlementValue","installmentValue","creditInstallments","creditInstallmentValue","creditItem","formatCurrency","installmentItem","generalDeadlineDays","savedData","parsedData","p","error","saveData","productsToDisplay","tbody","hasAnyDiscount","index","row","createProductRow","createAdditionalProductRow","addRow","colSpan","updateTableHeader","checkIfHasAnyDiscount","thead","isCustom","effectiveDiscount","discountedPrice","calculateDiscountedPrice","totalPrice","calculateTotalPrice","discountColumn","e","productId","quantity","updateProductRowCalculations","discount","updateAdditionalProductRowCalculations","price","additionalIndex","value","dateDisplay","updateTransportDisplay","newInstallments","filterProducts","toggleClearSearchButton","toggleEmptyLines","clearOrder","clearAllQuantities","copySettlementValue","saveOrderConsolidated","saveOrderToHistory","printOrderAsPDF","addNewProduct","clearProductSearch","clearQuantities","exportToExcel","printExpeditionAsPDF","showAddTransportModal","scrollToTop","scrollToBottom","scrollToTopBtn","scrollToBottomBtn","discountedPriceCell","totalPriceCell","totalQuantity","calculateTotalQuantity","totalWeight","calculateTotalWeight","grossValue","calculateGrossValue","generalDiscountValue","calculateGeneralDiscountValue","discountedValue","calculateDiscountedValue","finalValue","calculateFinalValue","profit","calculateProfit","totalQuantityElement","totalWeightElement","grossValueEl","generalDiscountValueEl","freightValueEl","settlementValueEl","finalValueEl","profitValueEl","profitItemEl","creditPaidValueEl","discountedValueEl","creditInstallmentValueEl","boletoInstallmentValueEl","boletoInstallments","boletoInstallmentValue","settlementValueElement","valueToCopy","err","pkg","generateFileName","rawValue","settlementDateText","textToCopy","saveOrderAsImage","fileName","printContent","createPrintableContent","canvas","link","jsPDFClass","imgData","pdf","imgWidth","pageHeight","imgHeight","heightLeft","position","printDiv","formattedOrderDate","productsHTML","tableHeader","generatePaymentConditionsHTML","html","paymentMethods","pixCheckbox","pixDetails","transferCheckbox","transferDetails","boletoCheckbox","installments","method","formatCurrencyForExcel","data","productHeader","wb","ws","newProduct","normalizeText","text","searchTerm","normalizedSearchTerm","filteredProducts","searchValue","clearBtn","searchInput","catalogPrice","total","packaging","hideEmpty","quantityInput","createExpeditionPrintableContent","pdfWidth","pdfHeight","margin","generateExpeditionPaymentConditionsHTML","createPackagingRow","addNewPackaging","removePackaging","updatePackaging","field","weightTotalElement","transportDisplay","modal","input","addNewTransportOption","closeTransportModal","newOption","select","option","HISTORY_STORAGE_KEY","getOrderHistory","history","orderData","timestamp","historyEntry","deleteOrderFromHistory","id","filteredHistory","item","loadOrderFromHistory","entry","closeHistoryModal","setupKeyboardShortcuts","activeElement","inputs","currentIndex","setupRowHighlight","table","r","openHistoryModal","renderHistoryList","filterType","historyList","todayStr","dateToCheck","ts","itemDateStr","weekAgo","weekAgoStr","monthAgo","monthAgoStr","normalizedSearch","btn","deleteHistoryItem","dashboardModal","updateDashboard","openDashboardModal","closeDashboardModal","period","totalSales","sum","totalProfit","orderCount","avgTicket","updateSalesChart","updateProductsChart","ctx","salesByDate","date","labels","label","productSales","sorted","a","b","historyBtn","dashboardBtn","historyModalClose","dashboardModalClose","historySearch","historyFilter","dashboardPeriod","historyModal"],"mappings":"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"}